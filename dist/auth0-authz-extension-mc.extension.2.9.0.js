module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){const n=r(1),i=r(2),o=r(4),a=(e,t)=>(o.info("Starting Authorization Extension - Version:","2.9.0"),o.info(" > WT_URL:",e("WT_URL")),o.info(" > PUBLIC_WT_URL:",e("PUBLIC_WT_URL")),r(6)(e,t));let s=(e,t,r)=>{setImmediate(()=>{t.x_wt&&t.x_wt.ectx&&t.x_wt.ectx.PUBLIC_WT_URL||!1||i.setValue("PUBLIC_WT_URL",n.urlHelpers.getWebtaskUrl(t)),(s=n.createServer(a))(e,t,r)})};e.exports=((e,t,r)=>{s(e,t,r)})},function(e,t){e.exports=require("auth0-extension-hapi-tools@1.3.1")},function(e,t,r){"use strict";r.r(t);var n=r(3);t.default=Object(n.config)()},function(e,t){e.exports=require("auth0-extension-tools@1.3.2")},function(e,t,r){const n=r(5);n.emitErrs=!0;const i=new n.Logger({transports:[new n.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});e.exports=i},function(e,t){e.exports=require("winston@1.0.0")},function(e,t,r){"use strict";r.r(t);var n=r(2),i=r(7),o=r(10),a=r(11),s=r(14),u=r(4),c=r.n(u);t.default=((e,t,r)=>(null==r&&(r=(e=>{e?(c.a.error("Hapi initialization failed."),c.a.error(e)):c.a.info("Hapi initialization completed.")})),n.default.setProvider(t=>e(t)||Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})[t]),Object(o.init)(new i.default({provider:Object(a.createProvider)(t)})),Object(s.default)(r)))},function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return f});var n=r(8),i=r.n(n),o=r(9),a=r.n(o),s=r(3),u=r(2);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d=(e=[],t="Record with that identifier is already exists.",r)=>0===e.length?null:r&&1===e.length&&e[0]._id===r?null:a.a.reject(new s.ValidationError(t));class f{constructor(e={}){if(!e.provider)throw new s.ArgumentError("The 'provider' has to be set when initializing the database.");this.provider=e.provider}getStatus(){return Object(u.default)("STORAGE_TYPE")&&"webtask"!==Object(u.default)("STORAGE_TYPE")?a.a.resolve({size:null,type:Object(u.default)("STORAGE_TYPE")}):this.provider.storageContext.read().then(e=>({size:Buffer.byteLength(JSON.stringify(e),"utf8"),type:"default"}))}canChange(e,t,r){return this.provider.getAll(e).then(e=>i.a.filter(e,e=>e[t]&&i.a.includes(e[t],r))).then(r=>{if(r.length){const n=r.map(e=>e.name).join(", "),i=`Unable to touch ${t} while used in ${e}: ${n}`;return a.a.reject(new s.ValidationError(i))}return a.a.resolve()})}getApiKey(){return this.provider.getAll("configuration").then(e=>e.length?e[0].apikey:null)}updateApiKey(e){return this.provider.getAll("configuration").then(e=>e.length?e[0]:{}).then(t=>this.provider.update("configuration","v1",l(l({},t),{},{apikey:e}),!0))}getConfiguration(){return this.provider.getAll("configuration").then(e=>e.length?e[0]:null)}updateConfiguration(e){return this.provider.update("configuration","v1",e,!0)}getRules(){return this.provider.getAll("rules")}createRule(e){return this.provider.create("rules",e)}getPermissions(){return this.provider.getAll("permissions")}getPermission(e){return this.provider.get("permissions",e)}createPermission(e){return this.getPermissions().then(t=>d(t.filter(t=>t.name.toLowerCase()===e.name.toLowerCase()&&t.applicationId===e.applicationId),`Permission with name "${e.name}" already exists for this application`)).then(()=>this.provider.create("permissions",e))}updatePermission(e,t){return this.getPermissions().then(r=>d(r.filter(e=>e.name.toLowerCase()===t.name.toLowerCase()&&e.applicationId===t.applicationId),`Permission with name "${t.name}" already exists for this application`,e)).then(()=>this.canChange("roles","permissions",e)).then(()=>this.canChange("groups","permissions",e)).then(()=>this.provider.update("permissions",e,t))}deletePermission(e){return this.canChange("roles","permissions",e).then(()=>this.provider.delete("permissions",e))}getRoles(){return this.provider.getAll("roles")}getRole(e){return this.provider.get("roles",e)}createRole(e){return this.getRoles().then(t=>d(t.filter(t=>t.name.toLowerCase()===e.name.toLowerCase()&&t.applicationId===e.applicationId),`Role with name "${e.name}" already exists for this application`)).then(()=>this.provider.create("roles",e))}updateRole(e,t){return this.getRoles().then(r=>d(r.filter(e=>e.name.toLowerCase()===t.name.toLowerCase()&&e.applicationId===t.applicationId),`Role with name "${t.name}" already exists for this application`,e)).then(()=>this.provider.update("roles",e,t))}deleteRole(e){return this.canChange("groups","roles",e).then(()=>this.provider.delete("roles",e))}getGroups(){return this.provider.getAll("groups")}getGroup(e){return this.provider.get("groups",e)}createGroup(e){return this.getGroups().then(t=>d(t.filter(t=>t.name.toLowerCase()===e.name.toLowerCase()),`Group with name "${e.name}" already exists`)).then(()=>this.provider.create("groups",e))}updateGroup(e,t){return this.getGroups().then(r=>d(r.filter(e=>e.name.toLowerCase()===t.name.toLowerCase()),`Group with name "${t.name}" already exists`,e)).then(()=>this.provider.update("groups",e,t))}deleteGroup(e){return this.canChange("groups","nested",e).then(()=>this.provider.delete("groups",e))}getApplications(){return this.provider.getAll("applications")}getApplication(e){return this.provider.get("applications",e)}updateApplication(e,t){return this.provider.update("applications",e,t,!0)}}},function(e,t){e.exports=require("lodash@3.10.1")},function(e,t){e.exports=require("bluebird@3.5.0")},function(e,t){let r=null;e.exports.init=(e=>{r=e}),e.exports.getDb=(()=>{if(!r)throw new Error("The database has not been initialized.");return r})},function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"createProvider",function(){return l});var n=r(12),i=r.n(n),o=r(13),a=r(3),s=r(2),u=r(4),c=r.n(u);function l(t){switch(Object(s.default)("STORAGE_TYPE")){case"s3":{c.a.info("Initializing the S3 Storage Context.");const e=new o.S3StorageContext({path:Object(s.default)("S3_PATH"),bucket:Object(s.default)("S3_BUCKET"),keyId:Object(s.default)("S3_KEY"),keySecret:Object(s.default)("S3_SECRET"),defaultData:{}});return new a.BlobRecordProvider(e,{concurrentWrites:!1})}case"webtask":default:{c.a.info("Initializing the Webtask Storage Context.");const r=t?new a.WebtaskStorageContext(t,{force:0}):new a.FileStorageContext(i.a.join(e,"../../data.json"),{mergeWrites:!0});return new a.BlobRecordProvider(r,{concurrentWrites:!1})}}}}.call(this,"/")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("auth0-extension-s3-tools@1.1.1")},function(e,t,r){"use strict";r.r(t);var n=r(15),i=r.n(n),o=r(16),a=r.n(o),s=r(17),u=r.n(s),c=r(18),l=r.n(c),p=r(19),d=r.n(p),f=r(20),h=r.n(f),g=r(21),m=r.n(g),y=r(22),v=r.n(y),_=r(2),b=r(4),E=r.n(b),w=r(23),O=r.n(w);t.default=(e=>{const t={register:a.a,options:{ops:{interval:3e4},reporters:{console:[]}}},r={register:v.a,options:{documentationPage:!1,swaggerUI:!1}};t.options.reporters.console.push(new m.a({color:!!Object(_.default)("LOG_COLOR")})),t.options.reporters.console.push("stdout");const n=l()({}),o=new i.a.Server;return o.connection({host:"localhost",port:3e3,routes:{cors:!0,validate:{failAction:n.failAction}}}),o.register([t,u.a,d.a,h.a,r,...O.a],t=>t?e(t,null):(E.a.debug=((...e)=>{o.log(["debug"],e.join(" "))}),E.a.info=((...e)=>{o.log(["info"],e.join(" "))}),E.a.error=((...e)=>{o.log(["error"],e.join(" "))}),e(null,o))),o.ext("onPreResponse",(e,t)=>(e.response&&e.response.isBoom&&e.response.output&&(o.log(["error"],`Request: ${e.method.toUpperCase()} ${e.url.path}`),o.log(["error"],`Response: ${JSON.stringify(e.response,null,2)}`)),t.continue())),o})},function(e,t){e.exports=require("@auth0/hapi@13.6.0")},function(e,t){e.exports=require("good@7.0.1")},function(e,t){e.exports=require("inert@4.0.1")},function(e,t){e.exports=require("relish@0.2.4")},function(e,t){e.exports=require("blipp@2.3.0")},function(e,t){e.exports=require("hapi-auth-jwt2@7.0.1")},function(e,t){e.exports=require("good-console@6.1.2")},function(e,t){e.exports=require("hapi-swagger@7.4.0")},function(e,t,r){e.exports=[{register:r(24)},{register:r(31)},{register:r(32)},{register:r(33)},{register:r(37)},{register:r(156)},{register:r(157)}]},function(e,t,r){"use strict";r.r(t);var n=r(25),i=r.n(n),o=r(26),a=r.n(o),s=r(27),u=r.n(s),c=r(28),l=r.n(c),p=r(1),d=r(2),f=r(29);const h=(e,t,r)=>{e.auth.scheme("extension-secret",()=>({authenticate:(e,t)=>{const r=e.headers["x-api-key"];return e.storage.getApiKey().then(e=>r&&r===(e=>a.a.createHmac("sha256",`${e} + ${Object(d.default)("AUTH0_CLIENT_SECRET")}`).update(Object(d.default)("EXTENSION_SECRET")).digest("hex"))(e)?t.continue({credentials:{user:"rule"}}):t(i.a.unauthorized("Invalid API Key")))}})),e.auth.strategy("extension-secret","extension-secret");const n={dashboardAdmin:{key:Object(d.default)("EXTENSION_SECRET"),verifyOptions:{audience:"urn:api-authz",issuer:Object(d.default)("PUBLIC_WT_URL"),algorithms:["HS256"]}},resourceServer:{key:u.a.hapiJwt2Key({cache:!0,rateLimit:!0,jwksRequestsPerMinute:2,jwksUri:`https://${Object(d.default)("AUTH0_DOMAIN")}/.well-known/jwks.json`}),verifyOptions:{audience:"urn:auth0-authz-api",issuer:`https://${Object(d.default)("AUTH0_DOMAIN")}/`,algorithms:["RS256"]}}};e.auth.strategy("jwt","jwt",{complete:!0,verifyFunc:(e,t,r)=>{if(!e)return r(null,!1);const o=t.headers.authorization;if(o&&0===o.indexOf("Bearer ")){const t=o.split(" ")[1];if(e&&e.payload&&e.payload.iss===`https://${Object(d.default)("AUTH0_DOMAIN")}/`)return n.resourceServer.key(e,(o,a)=>o?r(i.a.wrap(o),null,null):l.a.verify(t,a,n.resourceServer.verifyOptions,t=>t?r(i.a.unauthorized("Invalid token","Token"),null,null):e.payload.gty&&"client-credentials"!==e.payload.gty?r(i.a.unauthorized("Invalid token","Token"),null,null):e.payload.sub.endsWith("@clients")?(e.payload.scope&&"string"==typeof e.payload.scope&&(e.payload.scope=e.payload.scope.split(" ")),r(null,!0,e.payload)):r(i.a.unauthorized("Invalid token","Token"),null,null)));if(e&&e.payload&&e.payload.iss===Object(d.default)("PUBLIC_WT_URL"))return l.a.verify(t,n.dashboardAdmin.key,n.dashboardAdmin.verifyOptions,t=>t?r(i.a.unauthorized("Invalid token","Token"),null,null):e.payload.access_token&&e.payload.access_token.length?(e.payload.scope=f.scopes.map(e=>e.value),r(null,!0,e.payload)):r(i.a.unauthorized("Invalid token","Token"),null,null))}return r(null,!1)}}),e.auth.default("jwt");const o={register:p.plugins.dashboardAdminSession,options:{stateKey:"authz-state",nonceKey:"authz-nonce",sessionStorageKey:"authz:apiToken",rta:Object(d.default)("AUTH0_RTA").replace("https://",""),domain:Object(d.default)("AUTH0_DOMAIN"),scopes:"read:resource_servers create:resource_servers update:resource_servers delete:resource_servers read:clients read:connections read:rules create:rules update:rules update:rules_configs read:users",baseUrl:Object(d.default)("PUBLIC_WT_URL"),audience:"urn:api-authz",secret:Object(d.default)("EXTENSION_SECRET"),clientName:"Authorization Extension",onLoginSuccess:(e,t,r)=>e?(e.scope=f.scopes.map(e=>e.value),r(null,!0,e)):r(null,!1)}};e.register(o,e=>{e&&r(e),r()})};h.attributes={name:"auth"},t.default=h},function(e,t){e.exports=require("boom@3.2.2")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("jwks-rsa@1.1.1")},function(e,t){e.exports=require("jsonwebtoken@7.1.9")},function(e,t,r){"use strict";r.r(t),r.d(t,"getApi",function(){return d}),r.d(t,"createApi",function(){return f}),r.d(t,"updateApi",function(){return h}),r.d(t,"deleteApi",function(){return g}),r.d(t,"scopes",function(){return m});var n=r(9),i=r.n(n),o=r(30),a=r.n(o),s=r(3),u=r(2);const c=[{value:"read:users"},{value:"read:applications"},{value:"read:connections"},{value:"read:configuration"},{value:"update:configuration"},{value:"read:groups"},{value:"create:groups"},{value:"update:groups"},{value:"delete:groups"},{value:"read:roles"},{value:"create:roles"},{value:"update:roles"},{value:"delete:roles"},{value:"read:permissions"},{value:"create:permissions"},{value:"update:permissions"},{value:"delete:permissions"},{value:"read:resource-server"},{value:"create:resource-server"},{value:"update:resource-server"},{value:"delete:resource-server"}],l=(e,t,r,n)=>new i.a((o,c)=>(e=e,e.auth&&e.auth.credentials&&e.auth.credentials.access_token&&e.auth.credentials.access_token.length?i.a.resolve(e.auth.credentials.access_token):s.managementApi.getAccessTokenCached(Object(u.default)("AUTH0_DOMAIN"),Object(u.default)("AUTH0_CLIENT_ID"),Object(u.default)("AUTH0_CLIENT_SECRET"))).then(e=>{a()(r,`https://${Object(u.default)("AUTH0_DOMAIN")}/api/v2/${t}`).send(n||{}).set("Content-Type","application/json").set("Authorization",`Bearer ${e}`).end((e,t)=>e?c(e):o(t.body))}));var p;const d=e=>l(e,"resource-servers","GET").then(e=>{return e.filter(e=>"urn:auth0-authz-api"===e.identifier)[0]||{}}),f=(e,t)=>{return l(e,"resource-servers","POST",{name:"auth0-authorization-extension-api",identifier:"urn:auth0-authz-api",signing_alg:"RS256",scopes:c,token_lifetime:t})},h=(e,t)=>d(e).then(r=>{return r.id?l(e,`resource-servers/${r.id}`,"PATCH",{token_lifetime:t||86400}):f(e,t||86400)}),g=(e,t)=>d(e).then(r=>r.id?l(e,`resource-servers/${r.id}`,"DELETE"):r.id||t?i.a.resolve():i.a.reject(new Error("Unable to disable resource-server. Is it enabled?"))),m=c},function(e,t){e.exports=require("superagent@1.2.0")},function(e,t,r){"use strict";r.r(t),function(e){var n=r(12),i=r.n(n);const o=(t,r,n)=>{t.route({method:"GET",path:"/app/{param*}",config:{auth:!1},handler:{directory:{path:i.a.join(e,"../../dist"),redirectToSlash:!0}}}),n()};o.attributes={name:"assets"},t.default=o}.call(this,"/")},function(e,t,r){"use strict";r.r(t);var n=r(1),i=r(2),o=r(4),a=r.n(o);const s=r(3),u=r(25),c=(e,t,r)=>{e.decorate("server","handlers",{managementClient:n.handlers.managementApiClient({domain:Object(i.default)("AUTH0_DOMAIN"),clientId:Object(i.default)("AUTH0_CLIENT_ID"),clientSecret:Object(i.default)("AUTH0_CLIENT_SECRET"),logger:a.a.error}),validateHookToken:((e,t,r)=>{if(null===e||void 0===e)throw new s.ArgumentError("Must provide the domain");if("string"!=typeof e||0===e.length)throw new s.ArgumentError(`The provided domain is invalid: ${e}`);if(null===t||void 0===t)throw new s.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof t||0===t.length)throw new s.ArgumentError(`The provided webtaskUrl is invalid: ${t}`);if(null===r||void 0===r)throw new s.ArgumentError("Must provide the extensionSecret");if("string"!=typeof r||0===r.length)throw new s.ArgumentError(`The provided extensionSecret is invalid: ${r}`);return n=>{if(null===n||void 0===n)throw new s.ArgumentError("Must provide the hookPath");if("string"!=typeof n||0===n.length)throw new s.ArgumentError(`The provided hookPath is invalid: ${n}`);return{method(i,o){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const c=i.headers.authorization.split(" ")[1];try{if(a.a.info(`Validating hook token with signature: ${r.substr(0,4)}...`),s.validateHookToken(e,t,n,r,c))return o()}catch(e){return a.a.error("Invalid token:",c),o(u.wrap(e,401,e.message))}}const c=new s.HookTokenError(`Hook token missing for the call to: ${n}`);return o(u.unauthorized(c,401,c.message))}}}})(Object(i.default)("AUTH0_DOMAIN"),Object(i.default)("WT_URL"),Object(i.default)("EXTENSION_SECRET"))}),r()};c.attributes={name:"handlers"},t.default=c},function(e,t,r){"use strict";r.r(t),function(e){var n=r(34),i=r.n(n),o=r(35),a=r.n(o),s=r(12),u=r.n(s),c=r(1),l=r(2),p=r(36),d=r.n(p);const f=["/","/api","/configuration","/configuration/rule","/configuration/api","/roles","/roles/{id}","/groups","/groups/{id}","/permissions","/permissions/{id}","/users","/users/{id}","/import-export"],h=(t,r,n)=>{f.map(r=>t.route((t=>({method:"GET",path:t,config:{description:"Render HTML",auth:!1},handler:(t,r)=>{const n={AUTH0_DOMAIN:Object(l.default)("AUTH0_DOMAIN"),AUTH0_CLIENT_ID:Object(l.default)("AUTH0_CLIENT_ID"),BASE_URL:c.urlHelpers.getBaseUrl(t),API_BASE:c.urlHelpers.getBaseUrl(t),BASE_PATH:c.urlHelpers.getBasePath(t),SEARCH_ENGINE:"auth0.auth0.com"!==Object(l.default)("AUTH0_RTA").replace("https://","")?"v2":"v3"},o=Object(l.default)("CLIENT_VERSION");return o?r(a.a.render(d.a,{config:n,assets:{version:o}})):i.a.readFile(u.a.join(e,"../../dist/manifest.json"),"utf8",(e,t)=>{const i={config:n,assets:{app:"/app/bundle.js"}};!e&&t&&(i.assets=JSON.parse(t),i.assets.app&&(i.assets.app=`/app/${i.assets.app}`),i.assets.vendors&&(i.assets.vendors=`/app/${i.assets.vendors}`),i.assets.style&&(i.assets.style=`/app/${i.assets.style}`)),r(a.a.render(d.a,i))})}}))(r))),n()};h.attributes={name:"html"},t.default=h}.call(this,"/")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("ejs@2.3.1")},function(e,t){e.exports='<!DOCTYPE html>\n<html lang="en">\n<head>\n  <title>Auth0 - Authorization</title>\n  <meta charset="UTF-8" />\n  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/4.8.10/lib/logos/img/favicon.png">\n  <meta name="viewport" content="width=device-width, initial-scale=1">\n  <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css">\n  <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.8.10/index.min.css" />\n  <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css">\n  <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="<%= assets.style %>"><% } %>\n  <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/auth0-authz/assets/auth0-authz.ui.<%= assets.version %>.css"><% } %>\n</head>\n<body>\n  <div id="app"></div>\n  <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n  <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n  <% if (assets.vendors) { %><script type="text/javascript" src="<%= assets.vendors %>"><\/script><% } %>\n  <% if (assets.app) { %><script type="text/javascript" src="<%= assets.app %>"><\/script><% } %>\n  <% if (assets.version) { %>\n  <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-authz/assets/auth0-authz.ui.vendors.<%= assets.version %>.js"><\/script>\n  <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-authz/assets/auth0-authz.ui.<%= assets.version %>.js"><\/script>\n  <% } %>\n</body>\n</html>'},function(e,t,r){"use strict";r.r(t);var n=r(2);const i=(e,t,i)=>{e.route(r(38)(e)),e.route(r(86)(e)),e.route(r(87)(e)),e.route(r(88)(e)),e.route(r(89)(e)),e.route(r(90)(e)),e.route(r(91)(e)),e.route(r(94)(e)),e.route(r(98)(e)),e.route(r(99)(e)),e.route(r(100)(e)),e.route(r(101)(e)),e.route(r(102)(e)),e.route(r(103)(e)),e.route(r(104)(e)),e.route(r(105)(e)),e.route(r(106)(e)),e.route(r(107)(e)),e.route(r(108)(e)),e.route(r(109)(e)),e.route(r(111)(e)),e.route(r(112)(e)),e.route(r(113)(e)),e.route(r(114)(e)),e.route(r(115)(e)),e.route(r(117)(e)),e.route(r(118)(e)),e.route(r(119)(e)),e.route(r(120)(e)),e.route(r(121)(e)),e.route(r(123)(e)),e.route(r(124)(e)),e.route(r(125)(e)),e.route(r(126)(e)),e.route(r(127)(e)),e.route(r(128)(e)),e.route(r(130)(e)),e.route(r(131)(e)),e.route(r(132)(e)),e.route(r(133)(e)),e.route(r(135)(e)),e.route(r(139)(e)),e.route(r(141)(e)),e.route(r(143)(e)),e.route(r(144)(e)),e.route(r(145)(e)),e.route(r(147)(e)),e.route(r(148)(e)),e.route(r(149)(e)),e.route(r(150)(e)),e.route(r(151)(e)),e.route(r(152)(e)),e.route(r(153)(e)),e.route(r(154)(e)),e.route(r(155)(e)),e.route({method:"GET",path:"/admins/login",config:{auth:!1},handler:(e,t)=>t("Redirecting to login page...").redirect(`${Object(n.default)("PUBLIC_WT_URL")}/login`)}),i()};i.attributes={name:"routes"},t.default=i},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(40),a=r(41);t.default=(()=>({method:"POST",path:"/api/users/{userId}/policy/{clientId}",config:{auth:{strategies:["jwt","extension-secret"]},description:"Execute the authorization policy for a user in the context of a client. This will return the user's groups but also roles and permissions that apply to the current client.",tags:["api"],validate:{params:{userId:i.a.string().required(),clientId:i.a.string().required()},payload:o.default}},handler:(e,t)=>{const{userId:r,clientId:n}=e.params,{connectionName:i,groups:o}=e.payload;return e.storage.provider&&e.storage.provider.storageContext&&e.storage.provider.storageContext.read?Object(a.getUserData)(e.storage,r,n,i,o).then(e=>t(e)).catch(e=>t.error(e)):t.error(new Error("Storage error."))}}))},function(e,t){e.exports=require("joi@9.0.4")},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({connectionName:i.a.string().required(),groups:i.a.array().items(i.a.string())})},function(e,t,r){"use strict";r.r(t),r.d(t,"getConnectionsCached",function(){return y}),r.d(t,"getPermissionsCached",function(){return v}),r.d(t,"getRolesCached",function(){return _}),r.d(t,"getGroupsCached",function(){return b}),r.d(t,"getMappingsWithNames",function(){return E}),r.d(t,"getChildGroups",function(){return w}),r.d(t,"getParentGroups",function(){return O}),r.d(t,"getRolesForGroups",function(){return j}),r.d(t,"getRolesForUser",function(){return x}),r.d(t,"getPermissionsForRoles",function(){return A}),r.d(t,"getPermissionsByRoles",function(){return S}),r.d(t,"getMembers",function(){return T}),r.d(t,"getDynamicUserGroups",function(){return k}),r.d(t,"getUserGroups",function(){return I}),r.d(t,"getGroupExpanded",function(){return P}),r.d(t,"getGroupsExpanded",function(){return L}),r.d(t,"getUserData",function(){return N});var n=r(8),i=r.n(n),o=r(42),a=r.n(o),s=r(9),u=r.n(s),c=r(83),l=r.n(c),p=r(84);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g=e=>(...t)=>new u.a((r,n)=>{setImmediate(()=>{try{r(e(...t))}catch(e){n(e)}})}),m=e=>({_id:e._id,name:e.name,description:e.description}),y=l()({load:(e,t)=>{Object(p.default)(e,"connections",{fields:"id,name,strategy"}).then(e=>i.a.chain(e).sortBy(e=>e.name.toLowerCase()).value()).then(e=>t(null,e)).catch(e=>t(e))},hash:e=>e.hash||"connections",max:100,maxAge:a.a.get("DATA_CACHE_MAX_AGE")}),v=l()({load:(e,t)=>{e.getPermissions().then(e=>{t(null,e)}).catch(e=>t(e))},hash:e=>e.hash||"permissions",max:100,maxAge:a.a.get("DATA_CACHE_MAX_AGE")}),_=l()({load:(e,t)=>{e.getRoles().then(e=>{t(null,e)}).catch(e=>t(e))},hash:e=>e.hash||"roles",max:100,maxAge:a.a.get("DATA_CACHE_MAX_AGE")}),b=l()({load:(e,t)=>{e.getGroups().then(e=>{t(null,e)}).catch(e=>t(e))},hash:e=>e.hash||"groups",max:100,maxAge:a.a.get("DATA_CACHE_MAX_AGE")}),E=(e,t)=>new u.a((r,n)=>{y(e,(e,o)=>{if(e)return n(e);const a=[];return t.forEach(e=>{const t=i.a.find(o,{name:e.connectionName});if(t){const r=e;r.connectionName=`${t.name} (${t.strategy})`,a.push(r)}}),r(a)})}),w=(e,t)=>{const r=[],n=t=>{if(-1===r.indexOf(t)){r.push(t);const o=i.a.find(e,{_id:t});o&&o.nested&&i.a.forEach(o.nested,e=>{n(e)})}};return t.forEach(e=>n(e._id)),i.a.filter(e,e=>r.indexOf(e._id)>-1)},O=(e,t)=>{const r=[],n=t=>{if(-1===r.indexOf(t)){r.push(t),i.a.filter(e,e=>i.a.includes(e.nested||[],t)).forEach(e=>n(e._id))}};return t.forEach(e=>n(e._id)),i.a.filter(e,e=>r.indexOf(e._id)>-1)},j=(e,t)=>{const r=[],n={};return e.forEach(e=>{e.roles&&e.roles.forEach(t=>{n[t]||(n[t]=e)})}),t.forEach(e=>{n[e._id]&&r.push({role:e,group:n[e._id]})}),r},x=(e,t)=>e.getGroups().then(e=>{const r=i.a.filter(e,e=>i.a.includes(e.members,t));return O(e,r).filter(e=>e.roles&&e.roles.length).map(e=>e.roles)}).then(e=>i.a.uniq(i.a.flattenDeep(e))).then(r=>e.getRoles().then(e=>{const n=i.a.filter(e,e=>i.a.includes(r,e._id)),o=i.a.filter(e,e=>e.users&&i.a.includes(e.users,t));return i.a.uniq([...n,...o],"_id")})),A=(e,t)=>e.getPermissions().then(e=>{const r=i.a.flattenDeep(i.a.map(t,e=>e.permissions));return e.filter(e=>i.a.includes(r,e._id))}),S=(e,t)=>new u.a((r,n)=>{v(e,(e,o)=>{if(e)return n(e);const a=[];return i.a.forEach(t,e=>{const t=o.filter(t=>i.a.includes(e.permissions,t._id));a.push(f(f({},e),{},{permissions:i.a.map(t,e=>({_id:e._id,name:e.name,description:e.description}))}))}),r(a)})}),T=e=>{const t={};return e.forEach(e=>{e.members&&e.members.forEach(r=>{t[r]||(t[r]=e)})}),Object.keys(t).map(e=>({userId:e,group:t[e]}))},C=(e,t,r)=>e&&i.a.filter(e,e=>((e,t,r)=>e.connectionName===t&&r.indexOf(e.groupName)>-1)(e,t,r)).length>0;function k(e,t,r,n){return new u.a((o,a)=>{if(!t)return o([]);if(!r||0===r.length)return o([]);return(t=>n&&n.length?t(null,n):b(e,t))((e,n)=>{if(e)return a(e);const s=i.a.filter(n,e=>C(e.mappings,t,r));return o(s)})})}function I(e,t,r,n){return Array.isArray(n)&&void 0!==n&&null!==n||(n=[]),new u.a((o,a)=>{b(e,(s,u)=>{if(s)return a(s);const c=i.a.filter(u,e=>i.a.includes(e.members,t));return k(e,r,[...n,...c.map(e=>e.name)],u).then(e=>{const t=O(u,i.a.union(c,e));return o(t)}).catch(a)})})}function P(e,t){return new u.a((r,n)=>{b(e,(o,a)=>o?n(o):_(e,(o,s)=>{if(o)return n(o);const u=i.a.find(a,{_id:t}),c=O(a,[u]).filter(e=>e._id!==u._id),l=j([u,...c],s).map(e=>e.role),p=e=>({_id:e._id,name:e.name,description:e.description,applicationId:e.applicationId,applicationType:e.applicationType,permissions:e.permissions&&e.permissions.map(m)});return S(e,l).then(e=>r({_id:u._id,name:u.name,description:u.description,roles:e.map(p)}))}))})}function L(e,t){return new u.a((r,n)=>{b(e,(i,o)=>i?n(i):_(e,(i,a)=>{if(i)return n(i);const s=O(o,t),u=j(s,a).map(e=>e.role),c=e=>({_id:e._id,name:e.name,description:e.description,applicationId:e.applicationId,applicationType:e.applicationType,permissions:e.permissions&&e.permissions.map(m)});return S(e,u).then(e=>r({groups:s.map(m),roles:e.map(c)}))}))})}function N(e,t,r,n,o){const a={groups:[],roles:[]};return e.provider.storageContext.read().then(s=>{const{groups:u=[],roles:c=[],permissions:l=[]}=s,p=i.a.filter(u,e=>i.a.includes(e.members,t));return Array.isArray(o)||(o=[]),g(k)(e,n,[...o,...p.map(e=>e.name)],u).then(g(e=>{const t=O(u,i.a.union(p,e));return a.groups=i.a.uniq(t.map(e=>e.name)),t})).then(g(e=>{const n=j(e,c).map(e=>e.role),o=c.filter(e=>e.users&&e.users.indexOf(t)>-1),s=[...n,...o].filter(e=>e.applicationId===r);return a.roles=i.a.uniq(s.map(e=>e.name)),s})).then(g(e=>{const t=i.a.flattenDeep(i.a.map(e,e=>e.permissions)),r=l.filter(e=>i.a.includes(t,e._id));return a.permissions=i.a.uniq(r.map(e=>e.name)),a}))})}},function(e,t,r){r(43);var n=r(44),i=r(48).Provider,o=e.exports=new i;o.version=r(49).version,["argv","env","file","literal","memory"].forEach(function(e){var t=n.capitalize(e);o.__defineGetter__(t,function(){return r(50)("./"+e)[t]})}),o.key=n.key,o.path=n.path,o.loadFiles=n.loadFiles,o.loadFilesSync=n.loadFilesSync,o.formats=r(45),o.Provider=i},function(e,t){e.exports=require("async@2.1.2")},function(e,t,r){var n=r(34),i=r(43),o=r(45),a=r(47).Memory,s=t;s.path=function(e,t){return t=t||":",null==e?[]:e.split(t)},s.key=function(){return Array.prototype.slice.call(arguments).join(":")},s.keyed=function(){return Array.prototype.slice.call(arguments,1).join(arguments[0])},s.loadFiles=function(e,t){if(!e)return t(null,{});var r=Array.isArray(e)?{files:e}:e;r.format=r.format||o.json,i.map(r.files,function(e,t){n.readFile(e,function(e,n){return e?t(e):t(null,r.format.parse(n.toString()))})},function(e,r){return e?t(e):t(null,s.merge(r))})},s.loadFilesSync=function(e){if(e){var t=Array.isArray(e)?{files:e}:e;return t.format=t.format||o.json,s.merge(t.files.map(function(e){return t.format.parse(n.readFileSync(e,"utf8"))}))}},s.merge=function(e){var t=new a;return e.forEach(function(e){Object.keys(e).forEach(function(r){t.merge(r,e[r])})}),t.store},s.capitalize=function(e){return e&&e[0].toUpperCase()+e.slice(1)}},function(e,t,r){var n=r(46),i=t;i.json={stringify:function(e,t,r){return JSON.stringify(e,t||null,r||2)},parse:JSON.parse},i.ini=n},function(e,t){t.parse=t.decode=function(e){var t={},r=t,i=null,o=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i;return e.split(/[\r\n]+/g).forEach(function(e,n,s){if(e&&!e.match(/^\s*[;#]/)){var u=e.match(o);if(u){if(void 0!==u[1])return i=a(u[1]),void(r=t[i]=t[i]||{});var c=a(u[2]),l=!u[3]||a(u[4]);switch(l){case"true":case"false":case"null":l=JSON.parse(l)}c.length>2&&"[]"===c.slice(-2)&&(c=c.substring(0,c.length-2),r[c]?Array.isArray(r[c])||(r[c]=[r[c]]):r[c]=[]),Array.isArray(r[c])?r[c].push(l):r[c]=l}}}),Object.keys(t).filter(function(e,r,i){if(!t[e]||"object"!=typeof t[e]||Array.isArray(t[e]))return!1;var o=n(e),a=t,s=o.pop(),u=s.replace(/\\\./g,".");return o.forEach(function(e,t,r){a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}),(a!==t||u!==s)&&(a[u]=t[e],!0)}).forEach(function(e,r,n){delete t[e]}),t},t.stringify=t.encode=function e(t,i){var a=[];var s="";"string"==typeof i?i={section:i,whitespace:!1}:(i=i||{}).whitespace=!0===i.whitespace;var u=i.whitespace?" = ":"=";Object.keys(t).forEach(function(e,n,i){var c=t[e];c&&Array.isArray(c)?c.forEach(function(t){s+=o(e+"[]")+u+o(t)+"\n"}):c&&"object"==typeof c?a.push(e):s+=o(e)+u+o(c)+r});i.section&&s.length&&(s="["+o(i.section)+"]"+r+s);a.forEach(function(o,a,u){var c=n(o).join("\\."),l=(i.section?i.section+".":"")+c,p=e(t[o],{section:l,whitespace:i.whitespace});s.length&&p.length&&(s+=r),s+=p});return s},t.safe=o,t.unsafe=a;var r="undefined"!=typeof process&&"win32"===process.platform?"\r\n":"\n";function n(e){return e.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(function(e){return e.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")})}function i(e){return'"'===e.charAt(0)&&'"'===e.slice(-1)||"'"===e.charAt(0)&&"'"===e.slice(-1)}function o(e){return"string"!=typeof e||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&i(e)||e!==e.trim()?JSON.stringify(e):e.replace(/;/g,"\\;").replace(/#/g,"\\#")}function a(e,t){if(!i(e=(e||"").trim())){for(var r=!1,n="",o=0,a=e.length;o<a;o++){var s=e.charAt(o);if(r)-1!=="\\;#".indexOf(s)?n+=s:n+="\\"+s,r=!1;else{if(-1!==";#".indexOf(s))break;"\\"===s?r=!0:n+=s}}return r&&(n+="\\"),n.trim()}"'"===e.charAt(0)&&(e=e.substr(1,e.length-2));try{e=JSON.parse(e)}catch(e){}return e}},function(e,t,r){var n=r(44),i=t.Memory=function(e){e=e||{},this.type="memory",this.store={},this.mtimes={},this.readOnly=!1,this.loadFrom=e.loadFrom||null,this.logicalSeparator=e.logicalSeparator||":",this.loadFrom&&(this.store=n.loadFilesSync(this.loadFrom))};i.prototype.get=function(e){for(var t=this.store,r=n.path(e,this.logicalSeparator);r.length>0;){if(e=r.shift(),!t||!t.hasOwnProperty(e))return;t=t[e]}return t},i.prototype.set=function(e,t){if(this.readOnly)return!1;var r=this.store,i=n.path(e,this.logicalSeparator);if(0===i.length)return!(!t||"object"!=typeof t)&&(this.reset(),this.store=t,!0);for(this.mtimes[e]=Date.now();i.length>1;)r[e=i.shift()]&&"object"==typeof r[e]||(r[e]={}),r=r[e];return r[e=i.shift()]=t,!0},i.prototype.clear=function(e){if(this.readOnly)return!1;var t=this.store,r=t,i=n.path(e,this.logicalSeparator);delete this.mtimes[e];for(var o=0;o<i.length-1;o++){if("function"!=typeof(r=t[e=i[o]])&&"object"!=typeof r)return!1;t=r}return delete t[e=i[o]],!0},i.prototype.merge=function(e,t){if(this.readOnly)return!1;if("object"!=typeof t||Array.isArray(t)||null===t)return this.set(e,t);var r=this,i=this.store,o=n.path(e,this.logicalSeparator),a=e;for(this.mtimes[e]=Date.now();o.length>1;)i[e=o.shift()]||(i[e]={}),i=i[e];return"object"!=typeof i[e=o.shift()]||Array.isArray(i[e])?(i[e]=t,!0):Object.keys(t).every(function(e){return r.merge(n.keyed(r.logicalSeparator,a,e),t[e])})},i.prototype.reset=function(){return!this.readOnly&&(this.mtimes={},this.store={},!0)},i.prototype.loadSync=function(){return this.store||{}}},function(e,t,r){var n=r(43),i=r(44),o=t.Provider=function(e){e=e||{},this.stores={},this.sources=[],this.init(e)};["argv","env"].forEach(function(e){o.prototype[e]=function(){var t=[e].concat(Array.prototype.slice.call(arguments));return this.add.apply(this,t)}}),o.prototype.file=function(e,t){return 1==arguments.length?(t="string"==typeof e?{file:e}:e,e="file"):t="string"==typeof t?{file:t}:t,t.type="file",this.add(e,t)},["defaults","overrides"].forEach(function(e){o.prototype[e]=function(t){return(t=t||{}).type||(t.type="literal"),this.add(e,t)}}),o.prototype.use=function(e,t){(t=t||{}).type;var r=this.stores[e],n=r&&!function(e){return Object.keys(t).every(function(r){return t[r]===e[r]})}(r);return r&&!n||(n&&this.remove(e),this.add(e,t)),this},o.prototype.add=function(e,t,n){var o=(t=t||{}).type||e;if(!r(42)[i.capitalize(o)])throw new Error("Cannot add store with unknown type: "+o);return this.stores[e]=this.create(o,t,n),this.stores[e].loadSync&&this.stores[e].loadSync(),this},o.prototype.remove=function(e){return delete this.stores[e],this},o.prototype.create=function(e,t,n){return new(r(42)[i.capitalize(e.toLowerCase())])(t,n)},o.prototype.init=function(e){var t=this;e.type?this.add(e.type,e):e.store?this.add(e.store.name||e.store.type,e.store):e.stores&&Object.keys(e.stores).forEach(function(r){var n=e.stores[r];t.add(n.name||r||n.type,n)}),e.source?this.sources.push(this.create(e.source.type||e.source.name,e.source)):e.sources&&Object.keys(e.sources).forEach(function(r){var n=e.sources[r];t.sources.push(t.create(n.type||n.name||r,n))})},o.prototype.get=function(e,t){if("function"==typeof e&&(t=e,e=null),!t)return this._execute("get",1,e,t);var r,o=0,a=Object.keys(this.stores),s=this,u=[];n.whilst(function(){return void 0===r&&o<a.length},function(t){var n=s.stores[a[o]];if(o++,n.get.length>=2)return n.get(e,function(e,n){if(e)return t(e);(r=n)&&"object"==typeof r&&!Array.isArray(r)&&(u.push(r),r=void 0),t()});(r=n.get(e))&&"object"==typeof r&&!Array.isArray(r)&&(u.push(r),r=void 0),t()},function(e){return!e&&u.length&&(r=i.merge(u.reverse())),e?t(e):t(null,r)})},o.prototype.set=function(e,t,r){return this._execute("set",2,e,t,r)},o.prototype.required=function(e){if(!Array.isArray(e))throw new Error("Incorrect parameter, array expected");var t=[];if(e.forEach(function(e){void 0===this.get(e)&&t.push(e)},this),t.length)throw new Error("Missing required keys: "+t.join(", "));return!0},o.prototype.reset=function(e){return this._execute("reset",0,e)},o.prototype.clear=function(e,t){return this._execute("clear",1,e,t)},o.prototype.merge=function(){var e=this,t=Array.prototype.slice.call(arguments),r="function"==typeof t[t.length-1]&&t.pop(),i=t.pop(),o=t.pop();return o?this._execute("merge",2,o,i,r):Array.isArray(i)||"object"!=typeof i?function(e,t){if(t)return t(e);throw e}(new Error("Cannot merge non-Object into top-level."),r):n.forEach(Object.keys(i),function(t,r){return e._execute("merge",2,t,i[t],r)},r||function(){})},o.prototype.load=function(e){var t=this;function r(){var e=Object.keys(t.stores);return e.reverse(),e.map(function(e){return t.stores[e]})}function o(e){if(!e.loadSync)throw new Error("nconf store "+e.type+" has no loadSync() method");return e.loadSync()}function a(e,t){return e.load||e.loadSync?e.loadSync?t(null,e.loadSync()):e.load(t):t(new Error("nconf store "+e.type+" has no load() method"))}function s(e,t){if(!t)return i.merge(e.map(o));n.map(e,a,function(e,r){return e?t(e):t(null,i.merge(r))})}function u(e){e&&"object"==typeof e&&t.use("sources",{type:"literal",store:e})}return t.sources.length?function(){var n=t.sources.splice(0);if(n.reverse(),!e)return u(s(n)),s(r());s(n,function(t,n){return t?e(t):(u(n),s(r(),e))})}():s(r(),e)},o.prototype.save=function(e,t){t||"function"!=typeof e||(t=e,e=null);var r=this,o=Object.keys(this.stores);if(!t)return i.merge(o.reduce(function(e,t){var n=r.stores[t];if(n.saveSync){var i=n.saveSync();"object"==typeof i&&null!==i&&e.push(i)}return e},[]));n.reduce(o,[],function(t,n,i){var o=r.stores[n];if(o.save)return o.save(e,function(e,r){if(e)return i(e);"object"==typeof r&&null!==r&&t.push(r),i(null,t)});o.saveSync&&t.push(o.saveSync()),i(null,t)},function(e,r){return e?t(e):t(null,i.merge(r))})},o.prototype._execute=function(e,t){var r,o=Array.prototype.slice.call(arguments,2),a="function"==typeof o[o.length-1]&&o.pop(),s=-1!==["set","clear","merge","reset"].indexOf(e),u=this,c=[],l=Object.keys(this.stores);return a?n.forEach(l,function(r,n){var i=u.stores[r];return s&&i.readOnly?n():i[e].length>t?i[e].apply(i,o.concat(n)):n(null,i[e].apply(i,o))},function(e){return e?a(e):a()}):(l.forEach(function(t){if(void 0===r){var n=u.stores[t];if(s&&n.readOnly)return;(r=n[e].apply(n,o))&&"get"===e&&"object"==typeof r&&!Array.isArray(r)&&(c.push(r),r=void 0)}}),c.length&&(r=i.merge(c.reverse())),r)}},function(e){e.exports=JSON.parse('{"_from":"nconf@0.8.5","_id":"nconf@0.8.5","_inBundle":false,"_integrity":"sha1-8pQeFWGVL6kGu7MjKM+I1MY155Q=","_location":"/nconf","_phantomChildren":{"decamelize":"1.2.0","os-locale":"1.4.0","string-width":"1.0.2","strip-ansi":"3.0.1","wrap-ansi":"2.1.0","y18n":"3.2.1"},"_requested":{"type":"version","registry":true,"raw":"nconf@0.8.5","name":"nconf","escapedName":"nconf","rawSpec":"0.8.5","saveSpec":null,"fetchSpec":"0.8.5"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/nconf/-/nconf-0.8.5.tgz","_shasum":"f2941e1561952fa906bbb32328cf88d4c635e794","_spec":"nconf@0.8.5","_where":"/Users/marcoscastany/Repos/auth0-authorization-extension","author":{"name":"Charlie Robbins","email":"charlie.robbins@gmail.com"},"bugs":{"url":"https://github.com/flatiron/nconf/issues"},"bundleDependencies":false,"dependencies":{"async":"^1.4.0","ini":"^1.3.0","secure-keys":"^1.0.0","yargs":"^3.19.0"},"deprecated":false,"description":"Hierarchical node.js configuration with files, environment variables, command-line arguments, and atomic object merging.","devDependencies":{"coveralls":"^2.11.4","istanbul":"^0.4.1","vows":"0.8.x"},"engines":{"node":">= 0.4.0"},"homepage":"https://github.com/flatiron/nconf#readme","keywords":["configuration","key value store","plugabble"],"license":"MIT","main":"./lib/nconf","name":"nconf","repository":{"type":"git","url":"git+ssh://git@github.com/flatiron/nconf.git"},"scripts":{"cover":"istanbul cover vows -- test/*-test.js test/**/*-test.js  --spec","coveralls":"cat coverage/lcov.info | coveralls","test":"vows test/*-test.js test/**/*-test.js --spec"},"version":"0.8.5"}')},function(e,t,r){var n={"./argv":51,"./argv.js":51,"./env":79,"./env.js":79,"./file":80,"./file.js":80,"./literal":82,"./literal.js":82,"./memory":47,"./memory.js":47};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=50},function(e,t,r){var n=r(52),i=r(47).Memory,o=t.Argv=function(e,t){i.call(this,e),this.type="argv",this.readOnly=!0,this.options=e||!1,this.usage=t};n.inherits(o,i),o.prototype.loadSync=function(){return this.loadArgv(),this.store},o.prototype.loadArgv=function(){var e,t,n=this;if(e="object"==typeof this.options?r(53)(process.argv.slice(2)).options(this.options):r(53)(process.argv.slice(2)),"string"==typeof this.usage&&e.usage(this.usage),t=e.argv)return this.readOnly=!1,Object.keys(t).forEach(function(e){void 0!==t[e]&&n.set(e,t[e])}),this.showHelp=e.showHelp,this.help=e.help,this.readOnly=!0,this.store}},function(e,t){e.exports=require("util")},function(e,t,r){(function(t){var n=r(54),i=r(55),o=r(56),a=r(12),s=r(59),u=r(60),c=r(72),l=r(73);function p(e,f){e=e||[];var h,g={},m=null,y=null,v=null,_=l({directory:a.resolve(t,"./locales"),updateFiles:!1});f||(f=process.cwd()),g.$0=process.argv.slice(0,2).map(function(e,t){if(0!==t||!/\b(node|iojs)$/.test(e)){var r=d(f,e);return e.match(/^\//)&&r.length<e.length?r:e}}).join(" ").trim(),void 0!==Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})._&&process.argv[1]===Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})._&&(g.$0=Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})._.replace(a.dirname(process.execPath)+"/","")),g.resetOptions=g.reset=function(){return h={array:[],boolean:[],string:[],narg:{},key:{},alias:{},default:{},defaultDescription:{},choices:{},requiresArg:[],count:[],normalize:[],config:{},envPrefix:void 0},y=u(g,_),v=c(g,y,_),m=i(g,y),E={},w={},A=!0,O=!1,x=null,j=null,b={},g.parsed=!1,g},g.resetOptions(),g.boolean=function(e){return h.boolean.push.apply(h.boolean,[].concat(e)),g},g.array=function(e){return h.array.push.apply(h.array,[].concat(e)),g},g.nargs=function(e,t){return"object"==typeof e?Object.keys(e).forEach(function(t){g.nargs(t,e[t])}):h.narg[e]=t,g},g.choices=function(e,t){return"object"==typeof e?Object.keys(e).forEach(function(t){g.choices(t,e[t])}):h.choices[e]=(h.choices[e]||[]).concat(t),g},g.normalize=function(e){return h.normalize.push.apply(h.normalize,[].concat(e)),g},g.config=function(e,t,r){return"function"==typeof t&&(r=t,t=null),g.describe(e,t||y.deferY18nLookup("Path to JSON config file")),(Array.isArray(e)?e:[e]).forEach(function(e){h.config[e]=r||!0}),g},g.example=function(e,t){return y.example(e,t),g},g.command=function(e,t,r){return!1!==t&&y.command(e,t),r&&(b[e]=r),g};var b={};g.getCommandHandlers=function(){return b},g.string=function(e){return h.string.push.apply(h.string,[].concat(e)),g},g.default=function(e,t,r){return"object"==typeof e?Object.keys(e).forEach(function(t){g.default(t,e[t])}):(r&&(h.defaultDescription[e]=r),"function"==typeof t&&(h.defaultDescription[e]||(h.defaultDescription[e]=y.functionDescription(t)),t=t.call()),h.default[e]=t),g},g.alias=function(e,t){if("object"==typeof e)Object.keys(e).forEach(function(t){g.alias(t,e[t])});else{var r=null;Object.keys(h.alias).forEach(function(t){~h.alias[t].indexOf(e)&&(r=h.alias[t])}),r?r.push(t):h.alias[e]=(h.alias[e]||[]).concat(t),h.alias[t]&&(Array.prototype.push.apply(h.alias[e]||r,h.alias[t]),delete h.alias[t])}return g},g.count=function(e){return h.count.push.apply(h.count,[].concat(e)),g};var E={};g.demand=g.required=g.require=function(e,t,r){return"number"!=typeof t&&(r=t,t=1/0),"number"==typeof e?(E._||(E._={count:0,msg:null,max:t}),E._.count=e,E._.msg=r):Array.isArray(e)?e.forEach(function(e){g.demand(e,r)}):"string"==typeof r?E[e]={msg:r}:!0!==r&&void 0!==r||(E[e]={msg:void 0}),g},g.getDemanded=function(){return E},g.requiresArg=function(e){return h.requiresArg.push.apply(h.requiresArg,[].concat(e)),g},g.implies=function(e,t){return v.implies(e,t),g},g.usage=function(e,t){return t||"object"!=typeof e||(t=e,e=null),y.usage(e),t&&g.options(t),g},g.epilogue=g.epilog=function(e){return y.epilog(e),g},g.fail=function(e){return y.failFn(e),g},g.check=function(e){return v.check(e),g},g.defaults=g.default,g.describe=function(e,t){return h.key[e]=!0,y.describe(e,t),g},g.parse=function(e){return k(e)},g.option=g.options=function(e,t){if("object"==typeof e)Object.keys(e).forEach(function(t){g.options(t,e[t])});else{n("object"==typeof t,"second argument to option must be an object"),h.key[e]=!0,t.alias&&g.alias(e,t.alias);var r=t.demand||t.required||t.require;r&&g.demand(e,r),"config"in t&&g.config(e,t.configParser),"default"in t&&g.default(e,t.default),"nargs"in t&&g.nargs(e,t.nargs),"choices"in t&&g.choices(e,t.choices),"group"in t&&g.group(e,t.group),(t.boolean||"boolean"===t.type)&&(g.boolean(e),t.alias&&g.boolean(t.alias)),(t.array||"array"===t.type)&&(g.array(e),t.alias&&g.array(t.alias)),(t.string||"string"===t.type)&&(g.string(e),t.alias&&g.string(t.alias)),(t.count||"count"===t.type)&&g.count(e),t.defaultDescription&&(h.defaultDescription[e]=t.defaultDescription);var i=t.describe||t.description||t.desc;i&&g.describe(e,i),t.requiresArg&&g.requiresArg(e)}return g},g.getOptions=function(){return h};var w={};g.group=function(e,t){var r={};return w[t]=(w[t]||[]).concat(e).filter(function(e){return!r[e]&&(r[e]=!0)}),g},g.getGroups=function(){return w},g.env=function(e){return h.envPrefix=!1===e?void 0:e||"",g},g.wrap=function(e){return y.wrap(e),g};var O=!1;g.strict=function(){return O=!0,g},g.getStrict=function(){return O},g.showHelp=function(t){return g.parsed||k(e),y.showHelp(t),g};var j=null;g.version=function(e,t,r){return j=t||"version",y.version(e),g.boolean(j),g.describe(j,r||y.deferY18nLookup("Show version number")),g};var x=null;g.addHelpOpt=function(e,t){return x=e,g.boolean(e),g.describe(e,t||y.deferY18nLookup("Show help")),g},g.showHelpOnFail=function(e,t){return y.showHelpOnFail(e,t),g};var A=!0;g.exitProcess=function(e){return"boolean"!=typeof e&&(e=!0),A=e,g},g.getExitProcess=function(){return A},g.help=function(){return arguments.length>0?g.addHelpOpt.apply(g,arguments):(g.parsed||k(e),y.help())};var S=null;g.completion=function(e,t,r){return"function"==typeof t&&(r=t,t=null),S=e||"completion",t||!1===t||(t="generate bash completion script"),g.command(S,t),r&&m.registerFunction(r),g},g.showCompletionScript=function(e){return e=e||g.$0,console.log(m.generateCompletionScript(e)),g},g.locale=function(e){return 0===arguments.length?(I(),_.getLocale()):(C=!1,_.setLocale(e),g)},g.updateStrings=g.updateLocale=function(e){return C=!1,_.updateLocale(e),g};var T,C=!0;function k(e){e=function(e){if("string"==typeof e)return s(e);return e}(e);var t=o(e,h,_),r=t.argv,n=t.aliases;if(r.$0=g.$0,g.parsed=t,I(),S&&-1!==process.argv.join(" ").indexOf(m.completionKey)&&!r[m.completionKey])return r;for(var i,a=Object.keys(g.getCommandHandlers()),u=0;void 0!==(i=a[u]);u++)if(~r._.indexOf(i))return P(i,g,r),g.argv;if(S&&~r._.indexOf(S)&&!r[m.completionKey]&&(g.showCompletionScript(),A&&process.exit(0)),!(m.completionKey in r)){var c=!1;if(Object.keys(r).forEach(function(e){e===x&&r[e]?(c=!0,g.showHelp("log"),A&&process.exit(0)):e===j&&r[e]&&(c=!0,y.showVersion(),A&&process.exit(0))}),!c){if(t.error)throw t.error;r[m.completionKey]||(v.nonOptionCount(r),v.missingArgumentValue(r),v.requiredArguments(r),O&&v.unknownArguments(r,n),v.customChecks(r,n),v.limitedChoices(r),v.implications(r))}return L(r),r}m.getCompletion(function(e){(e||[]).forEach(function(e){console.log(e)}),A&&process.exit(0)})}function I(){if(C)try{var e=r(74);g.locale(e.sync({spawn:!1}))}catch(e){}}function P(e,t,r){L(r),t.getCommandHandlers()[e](t.reset(),r)}function L(e){Object.keys(h.key).forEach(function(t){~t.indexOf(".")||void 0===e[t]&&(e[t]=void 0)})}return g.detectLocale=function(e){return C=e,g},g.getDetectLocale=function(){return C},g.getUsageInstance=function(){return y},g.getValidationInstance=function(){return v},g.terminalWidth=function(){return r(70).width},Object.defineProperty(g,"argv",{get:function(){var t=null;try{t=k(e)}catch(e){y.fail(e.message)}return t},enumerable:!0}),T=g,Object.keys(T).forEach(function(e){"argv"===e?p.__defineGetter__(e,T.__lookupGetter__(e)):p[e]="function"==typeof T[e]?T[e].bind(T):T[e]}),g}function d(e,t){return a.relative(e,t)}p(process.argv.slice(2)),(e.exports=p).rebase=d}).call(this,"/")},function(e,t){e.exports=require("assert")},function(e,t,r){(function(t){var n=r(34),i=r(12);e.exports=function(e,r){var o={completionKey:"get-yargs-completions",getCompletion:function(t){var n=[],i=process.argv[process.argv.length-1],s=process.argv.slice(process.argv.indexOf("--"+o.completionKey)+1),u=e.parse(s);if(a){if(a.length<3){var c=a(i,u);return"function"==typeof c.then?c.then(function(e){process.nextTick(function(){t(e)})}).catch(function(e){process.nextTick(function(){throw e})}):t(c)}return a(i,u,function(e){t(e)})}for(var l=e.getCommandHandlers(),p=0,d=s.length;p<d;++p)if(l[s[p]])return l[s[p]](e.reset());i.match(/^-/)||r.getCommands().forEach(function(e){-1===s.indexOf(e[0])&&n.push(e[0])}),i.match(/^-/)&&Object.keys(e.getOptions().key).forEach(function(e){n.push("--"+e)}),t(n)},generateCompletionScript:function(e){var r=n.readFileSync(i.resolve(t,"../completion.sh.hbs"),"utf-8"),o=i.basename(e);return e.match(/\.js$/)&&(e="./"+e),(r=r.replace(/{{app_name}}/g,o)).replace(/{{app_path}}/g,e)}},a=null;return o.registerFunction=function(e){a=e},o}}).call(this,"/")},function(e,t,r){var n=r(57),i=r(12);function o(e){return void 0!==e?e+1:0}e.exports=function(e,t,a){t||(t={});var s=a.__,u=null,c={arrays:{},bools:{},strings:{},counts:{},normalize:{},configs:{},defaulted:{}};[].concat(t.array).filter(Boolean).forEach(function(e){c.arrays[e]=!0}),[].concat(t.boolean).filter(Boolean).forEach(function(e){c.bools[e]=!0}),[].concat(t.string).filter(Boolean).forEach(function(e){c.strings[e]=!0}),[].concat(t.count).filter(Boolean).forEach(function(e){c.counts[e]=!0}),[].concat(t.normalize).filter(Boolean).forEach(function(e){c.normalize[e]=!0}),Object.keys(t.config).forEach(function(e){c.configs[e]=t.config[e]});var l={},p={};I(t.key),I(t.alias),I(t.default);var d=t.default||{};Object.keys(d).forEach(function(e){/-/.test(e)&&!t.alias[e]&&(l[e]=l[e]||[]),(l[e]||[]).forEach(function(t){d[t]=d[e]})});var f={_:[]};Object.keys(c.bools).forEach(function(e){A(e,e in d&&d[e]),function(e){[].concat(l[e]||[],e).forEach(function(e){c.defaulted[e]=!0})}(e)});var h=[];-1!==e.indexOf("--")&&(h=e.slice(e.indexOf("--")+1),e=e.slice(0,e.indexOf("--")));for(var g=0;g<e.length;g++){var m,y,v,_,b,E,w=e[g];if(w.match(/^--.+=/))P((_=w.match(/^--([^=]+)=([\s\S]*)$/))[1],t.narg)?(e.splice(g+1,_[1],_[2]),g=j(g,_[1],e)):P(_[1],c.arrays)&&e.length>g+1?(e.splice(g+1,_[1],_[2]),g=x(g,_[1],e)):A(_[1],_[2]);else if(w.match(/^--no-.+/))A(y=w.match(/^--no-(.+)/)[1],!1);else if(w.match(/^--.+/))P(y=w.match(/^--(.+)/)[1],t.narg)?g=j(g,y,e):P(y,c.arrays)&&e.length>g+1?g=x(g,y,e):void 0===(b=e[g+1])||b.match(/^-/)||P(y,c.bools)||P(y,c.counts)?/^(true|false)$/.test(b)?(A(y,b),g++):A(y,L(N(y,c))):(A(y,b),g++);else if(w.match(/^-.\..+=/))A((_=w.match(/^-([^=]+)=([\s\S]*)$/))[1],_[2]);else if(w.match(/^-.\..+/))b=e[g+1],y=w.match(/^-(.\..+)/)[1],void 0===b||b.match(/^-/)||P(y,c.bools)||P(y,c.counts)?A(y,L(N(y,c))):(A(y,b),g++);else if(w.match(/^-[^-]+/)){v=w.slice(1,-1).split(""),m=!1;for(var O=0;O<v.length;O++){if(b=w.slice(O+2),v[O+1]&&"="===v[O+1]){E=w.slice(O+3),y=v[O],P(v[O],t.narg)?(e.splice(g+1,0,E),g=j(g,y,e)):P(y,c.arrays)&&e.length>g+1?(e.splice(g+1,0,E),g=x(g,y,e)):A(y,E),m=!0;break}if("-"!==b){if(/[A-Za-z]/.test(v[O])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(b)){A(v[O],b),m=!0;break}if(v[O+1]&&v[O+1].match(/\W/)){A(v[O],w.slice(O+2)),m=!0;break}A(v[O],L(N(v[O],c)))}else A(v[O],b)}y=w.slice(-1)[0],m||"-"===y||(P(y,t.narg)?g=j(g,y,e):P(y,c.arrays)&&e.length>g+1?g=x(g,y,e):!e[g+1]||/^(-|--)[^-]/.test(e[g+1])||P(y,c.bools)||P(y,c.counts)?e[g+1]&&/true|false/.test(e[g+1])?(A(y,e[g+1]),g++):A(y,L(N(y,c))):(A(y,e[g+1]),g++))}else f._.push(c.strings._||!q(w)?w:Number(w))}function j(e,r,n){var i=P(r,t.narg);n.length-(e+1)<i&&(u=Error(s("Not enough arguments following: %s",r)));for(var o=e+1;o<i+e+1;o++)A(r,n[o]);return e+i}function x(e,t,r){for(var n=e+1;n<r.length&&!/^-/.test(r[n]);n++)e=n,A(t,r[n]);return e}function A(e,t){if(function(e){[].concat(l[e]||[],e).forEach(function(e){delete c.defaulted[e]})}(e),(P(e,c.bools)||P(e,c.counts))&&"string"==typeof t&&(t="true"===t),/-/.test(e)&&(!l[e]||!l[e].length)){var r=n(e);l[e]=[r],p[r]=!0}var a=!P(e,c.strings)&&q(t)?Number(t):t;P(e,c.counts)&&(a=o);var s=e.split(".");k(f,s,a),~e.indexOf(".")&&l[e]&&l[e].forEach(function(e){e=e.split("."),k(f,e,a)}),(l[s[0]]||[]).forEach(function(e){if(e=e.split("."),s.length>1){var t=[].concat(s);t.shift(),e=e.concat(t)}k(f,e,a)});for(var u=[e].concat(l[e]||[]),d=0,h=u.length;d<h;d++)if(c.normalize[u[d]]){u.forEach(function(e){f.__defineSetter__(e,function(e){t=i.normalize(e)}),f.__defineGetter__(e,function(){return"string"==typeof t?i.normalize(t):t})});break}}function S(e,t,r){if(void 0!==e.envPrefix){var i="string"==typeof e.envPrefix?e.envPrefix:"";Object.keys(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})).forEach(function(e){if(""===i||0===e.lastIndexOf(i,0)){var o=n(e.substring(i.length));!(r&&c.configs[o]||!r)||o in t&&!c.defaulted[o]||A(o,Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})[e])}})}}function T(e,t,r){Object.keys(r).forEach(function(n){C(e,n.split("."))||(k(e,n.split("."),r[n]),(t[n]||[]).forEach(function(t){C(e,t.split("."))||k(e,t.split("."),r[n])}))})}function C(e,t){var r=e;t.slice(0,-1).forEach(function(e){r=r[e]||{}});var n=t[t.length-1];return"object"==typeof r&&n in r}function k(e,t,r){var n=e;t.slice(0,-1).forEach(function(e){void 0===n[e]&&(n[e]={}),n=n[e]});var i=t[t.length-1];r===o?n[i]=o(n[i]):void 0===n[i]&&P(i,c.arrays)?n[i]=Array.isArray(r)?r:[r]:void 0===n[i]||"boolean"==typeof n[i]?n[i]=r:Array.isArray(n[i])?n[i].push(r):n[i]=[n[i],r]}function I(e){Object.keys(e||{}).forEach(function(e){l[e]||(l[e]=[].concat(t.alias[e]||[]),l[e].concat(e).forEach(function(t){if(/-/.test(t)){var r=n(t);l[e].push(r),p[r]=!0}}),l[e].forEach(function(t){l[t]=[e].concat(l[e].filter(function(e){return t!==e}))}))})}function P(e,t){var r=!1;return[].concat(l[e]||[],e).forEach(function(e){t[e]&&(r=t[e])}),r}function L(e){return{boolean:!0,string:"",array:[]}[e]}function N(e,t){var r="boolean";return t.strings&&t.strings[e]?r="string":t.arrays&&t.arrays[e]&&(r="array"),r}function q(e){return"number"==typeof e||(!!/^0x[0-9a-f]+$/i.test(e)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e))}return S(t,f,!0),function(e){var t={};T(t,l,d),Object.keys(c.configs).forEach(function(n){var o=e[n]||t[n];if(o)try{var a=null,l=i.resolve(process.cwd(),o);if("function"==typeof c.configs[n]){try{a=c.configs[n](l)}catch(e){a=e}if(a instanceof Error)return void(u=a)}else a=r(58)(l);Object.keys(a).forEach(function(t){(void 0===e[t]||c.defaulted[t])&&(delete e[t],A(t,a[t]))})}catch(t){e[n]&&(u=Error(s("Invalid JSON config file: %s",o)))}})}(f),S(t,f,!1),T(f,l,d),Object.keys(c.counts).forEach(function(e){A(e,d[e])}),h.forEach(function(e){f._.push(e)}),{argv:f,aliases:l,error:u,newAliases:p}}},function(e,t,r){"use strict";e.exports=function(){var e=[].map.call(arguments,function(e){return e.trim()}).filter(function(e){return e.length}).join("-");return e.length?1===e.length?e:/[_.\- ]+/.test(e)?(e=function(e){for(var t=!1,r=0;r<e.length;r++){var n=e.charAt(r);t&&/[a-zA-Z]/.test(n)&&n.toUpperCase()===n?(e=e.substr(0,r)+"-"+e.substr(r),t=!1,r++):t=n.toLowerCase()===n}return e}(e)).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()}):e===e.toUpperCase()?e.toLowerCase():e[0]!==e[0].toLowerCase()?e[0].toLowerCase()+e.slice(1):e:""}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=58},function(e,t){e.exports=function(e){for(var t=0,r=null,n=null,i=[],o=0;o<e.length;o++)" "!==(r=e.charAt(o))||n?r!==n?"'"!==r&&'"'!==r||n?(i[t]||(i[t]=""),i[t]+=r):n=r:n=null:t++;return i}},function(e,t,r){var n=r(61),i=r(69),o=r(62),a=r(70);e.exports=function(e,t){var r=t.__,s={},u=[];s.failFn=function(e){u.push(e)};var c=null,l=!0;s.showHelpOnFail=function(e,t){return"string"==typeof e?(t=e,e=!0):void 0===e&&(e=!0),c=t,l=e,s};var p,d=!1;s.fail=function(t){if(u.length)u.forEach(function(e){e(t)});else{if(d||(d=!0,l&&e.showHelp("error"),t&&console.error(t),c&&(t&&console.error(""),console.error(c))),!e.getExitProcess())throw new Error(t);process.exit(1)}},s.usage=function(e){p=e};var f=[];s.example=function(e,t){f.push([e,t||""])};var h=[];s.command=function(e,t){h.push([e,t||""])},s.getCommands=function(){return h};var g,m={};s.describe=function(e,t){"object"==typeof e?Object.keys(e).forEach(function(t){s.describe(t,e[t])}):m[e]=t},s.getDescriptions=function(){return m},s.epilog=function(e){g=e};var y=a.width?Math.min(80,a.width):null;s.wrap=function(e){y=e};s.deferY18nLookup=function(e){return"__yargsString__:"+e};var v="Options:";function _(e){var t=0;return Array.isArray(e)||(e=Object.keys(e).map(function(t){return[e[t]]})),e.forEach(function(e){t=Math.max(o(e[0]),t)}),y&&(t=Math.min(t,parseInt(.5*y,10))),t}s.help=function(){!function(){var t=e.getDemanded(),r=e.getOptions();(Object.keys(r.alias)||[]).forEach(function(n){r.alias[n].forEach(function(i){m[i]&&s.describe(n,m[i]),t[i]&&e.demand(n,t[i].msg),~r.boolean.indexOf(i)&&e.boolean(n),~r.count.indexOf(i)&&e.count(n),~r.string.indexOf(i)&&e.string(n),~r.normalize.indexOf(i)&&e.normalize(n),~r.array.indexOf(i)&&e.array(n)})})}();var t=e.getDemanded(),i=e.getGroups(),o=e.getOptions(),a=Object.keys(Object.keys(m).concat(Object.keys(t)).concat(Object.keys(o.default)).reduce(function(e,t){return"_"!==t&&(e[t]=!0),e},{})),u=n({width:y,wrap:!!y});if(p){var c=p.replace(/\$0/g,e.$0);u.div(c+"\n")}h.length&&(u.div(r("Commands:")),h.forEach(function(e){u.div({text:e[0],padding:[0,2,0,2],width:_(h)+4},{text:e[1]})}),u.div());var l=(Object.keys(o.alias)||[]).concat(Object.keys(e.parsed.newAliases)||[]);if(a=a.filter(function(t){return!e.parsed.newAliases[t]&&l.every(function(e){return-1===(o.alias[e]||[]).indexOf(t)})}),i[v]||(i[v]=[]),function(e,t,r){var n=[];Object.keys(r).forEach(function(e){n=n.concat(r[e])}),e.forEach(function(e){[e].concat(t[e]).some(function(e){return-1!==n.indexOf(e)})||r[v].push(e)})}(a,o.alias,i),Object.keys(i).forEach(function(e){if(i[e].length){u.div(r(e));var n=i[e].map(function(e){if(~l.indexOf(e))return e;for(var t,r=0;void 0!==(t=l[r]);r++)if(~(o.alias[t]||[]).indexOf(e))return t;return e}),a=n.reduce(function(e,t){return e[t]=[t].concat(o.alias[t]||[]).map(function(e){return(e.length>1?"--":"-")+e}).join(", "),e},{});n.forEach(function(e){var n=a[e],i=m[e]||"",c=null;~i.lastIndexOf("__yargsString__:")&&(i=r(i.substring("__yargsString__:".length))),~o.boolean.indexOf(e)&&(c="["+r("boolean")+"]"),~o.count.indexOf(e)&&(c="["+r("count")+"]"),~o.string.indexOf(e)&&(c="["+r("string")+"]"),~o.normalize.indexOf(e)&&(c="["+r("string")+"]"),~o.array.indexOf(e)&&(c="["+r("array")+"]");var l=[c,t[e]?"["+r("required")+"]":null,o.choices&&o.choices[e]?"["+r("choices:")+" "+s.stringifiedValues(o.choices[e])+"]":null,function(e,t){var n="["+r("default:")+" ";if(void 0===e&&!t)return null;if(t)n+=t;else switch(typeof e){case"string":case"object":n+=JSON.stringify(e);break;default:n+=e}return n+"]"}(o.default[e],o.defaultDescription[e])].filter(Boolean).join(" ");u.span({text:n,padding:[0,2,0,2],width:_(a)+4},i),l?u.div({text:l,padding:[0,0,0,2],align:"right"}):u.div()}),u.div()}}),f.length&&(u.div(r("Examples:")),f.forEach(function(t){t[0]=t[0].replace(/\$0/g,e.$0)}),f.forEach(function(e){u.div({text:e[0],padding:[0,2,0,2],width:_(f)+4},e[1])}),u.div()),g){var d=g.replace(/\$0/g,e.$0);u.div(d+"\n")}return u.toString()},s.showHelp=function(e){e=e||"error",console[e](s.help())},s.functionDescription=function(e){return["(",e.name?i(e.name,"-"):r("generated-value"),")"].join("")},s.stringifiedValues=function(e,t){var r="",n=t||", ",i=[].concat(e);return e&&i.length?(i.forEach(function(e){r.length&&(r+=n),r+=JSON.stringify(e)}),r):r};var b=null;return s.version=function(e,t,r){b=e},s.showVersion=function(){"function"==typeof b?console.log(b()):console.log(b)},s}},function(e,t,r){var n=r(62),i=r(63),o=r(68),a={right:function(e,t){e=e.trim();var r="",i=n(e);i<t&&(r=new Array(t-i+1).join(" "));return r+e},center:function(e,t){e=e.trim();var r="",i=n(e.trim());i<t&&(r=new Array(parseInt((t-i)/2,10)+1).join(" "));return r+e}},s=1,u=3;function c(e){this.width=e.width,this.wrap=e.wrap,this.rows=[]}function l(e,t,r){return e.border?/[.']-+[.']/.test(t)?"":t.trim().length?r:"  ":""}c.prototype.span=function(){this.div.apply(this,arguments).span=!0},c.prototype.div=function(){if(0===arguments.length&&this.div(""),this.wrap&&this._shouldApplyLayoutDSL.apply(this,arguments))return this._applyLayoutDSL(arguments[0]);for(var e,t=[],r=0;void 0!==(e=arguments[r]);r++)"string"==typeof e?t.push(this._colFromString(e)):t.push(e);return this.rows.push(t),t},c.prototype._shouldApplyLayoutDSL=function(){return 1===arguments.length&&"string"==typeof arguments[0]&&/[\t\n]/.test(arguments[0])},c.prototype._applyLayoutDSL=function(e){var t=this,r=e.split("\n"),i=0;return r.forEach(function(e){var r=e.split("\t");r.length>1&&n(r[0])>i&&(i=Math.min(Math.floor(.5*t.width),n(r[0])))}),r.forEach(function(e){var r=e.split("\t");t.div.apply(t,r.map(function(e,n){return{text:e.trim(),padding:t._measurePadding(e),width:0===n&&r.length>1?i:void 0}}))}),this.rows[this.rows.length-1]},c.prototype._colFromString=function(e){return{text:e,padding:this._measurePadding(e)}},c.prototype._measurePadding=function(e){var t=i(e);return[0,t.match(/\s*$/)[0].length,0,t.match(/^\s*/)[0].length]},c.prototype.toString=function(){var e=this,t=[];return e.rows.forEach(function(r,n){e.rowToString(r,t)}),(t=t.filter(function(e){return!e.hidden})).map(function(e){return e.text}).join("\n")},c.prototype.rowToString=function(e,t){var r,i,o,c,p=this,d="";return this._rasterize(e).forEach(function(f,h){d="",f.forEach(function(f,g){i="",o=e[g].width,c=p._negatePadding(e[g]),i+=f;for(var m=0;m<c-n(f);m++)i+=" ";e[g].align&&"left"!==e[g].align&&p.wrap&&(i=a[e[g].align](i,c),n(i)<c&&(i+=new Array(o-n(i)).join(" "))),(r=e[g].padding||[0,0,0,0])[u]&&(d+=new Array(r[u]+1).join(" ")),d+=l(e[g],i,"| "),d+=i,d+=l(e[g],i," |"),r[s]&&(d+=new Array(r[s]+1).join(" ")),0===h&&t.length>0&&(d=p._renderInline(d,t[t.length-1]))}),t.push({text:d.replace(/ +$/,""),span:e.span})}),t},c.prototype._renderInline=function(e,t){var r=e.match(/^ */)[0].length,i=t.text,o=n(i.trimRight());return t.span?this.wrap?r<o?e:(t.hidden=!0,i.trimRight()+new Array(r-o+1).join(" ")+e.trimLeft()):(t.hidden=!0,i+e):e},c.prototype._rasterize=function(e){var t,r,n,i=this,a=[],s=this._columnWidths(e);return e.forEach(function(e,u){if(e.width=s[u],n=i.wrap?o(e.text,i._negatePadding(e),{hard:!0}).split("\n"):e.text.split("\n"),e.border&&(n.unshift("."+new Array(i._negatePadding(e)+3).join("-")+"."),n.push("'"+new Array(i._negatePadding(e)+3).join("-")+"'")),e.padding){for(t=0;t<(e.padding[0]||0);t++)n.unshift("");for(t=0;t<(e.padding[2]||0);t++)n.push("")}n.forEach(function(e,t){a[t]||a.push([]),r=a[t];for(var n=0;n<u;n++)void 0===r[n]&&r.push("");r.push(e)})}),a},c.prototype._negatePadding=function(e){var t=e.width;return e.padding&&(t-=(e.padding[u]||0)+(e.padding[s]||0)),e.border&&(t-=4),t},c.prototype._columnWidths=function(e){var t,r=this,i=[],o=e.length,a=this.width;return e.forEach(function(e,t){e.width?(o--,i[t]=e.width,a-=e.width):i[t]=void 0}),o&&(t=Math.floor(a/o)),i.forEach(function(o,a){r.wrap?void 0===o&&(i[a]=Math.max(t,function(e){var t=e.padding||[],r=1+(t[u]||0)+(t[s]||0);e.border&&(r+=4);return r}(e[a]))):i[a]=e[a].width||n(e[a].text)}),i},e.exports=function(e){return new c({width:((e=e||{})||{}).width||80,wrap:"boolean"!=typeof e.wrap||e.wrap})}},function(e,t,r){"use strict";var n=r(63),i=r(65),o=r(66);e.exports=function(e){if("string"!=typeof e||0===e.length)return 0;var t=0;e=n(e);for(var r=0;r<e.length;r++){var a=i(e,r);a<=31||a>=127&&a<=159||(a>=65536&&r++,o(a)?t+=2:t++)}return t}},function(e,t,r){"use strict";var n=r(64)();e.exports=function(e){return"string"==typeof e?e.replace(n,""):e}},function(e,t,r){"use strict";e.exports=function(){return/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g}},function(e,t,r){"use strict";e.exports=function(e,t){if(null===e||void 0===e)throw TypeError();var r=(e=String(e)).length,n=t?Number(t):0;if(Number.isNaN(n)&&(n=0),!(n<0||n>=r)){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&r>n+1){var o=e.charCodeAt(n+1);if(o>=56320&&o<=57343)return 1024*(i-55296)+o-56320+65536}return i}}},function(e,t,r){"use strict";var n=r(67);e.exports=function(e){return!n(e)&&(e>=4352&&(e<=4447||9001===e||9002===e||11904<=e&&e<=12871&&12351!==e||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141))}},function(e,t,r){"use strict";e.exports=Number.isNaN||function(e){return e!=e}},function(e,t,r){"use strict";var n=r(62),i=r(63),o=["",""],a=39,s={0:0,1:22,2:22,3:23,4:24,7:27,8:28,9:29,30:39,31:39,32:39,33:39,34:39,35:39,36:39,37:39,90:39,40:49,41:49,42:49,43:49,44:49,45:49,46:49,47:49};function u(e){return o[0]+"["+e+"m"}function c(e,t,r){for(var n=!1,a=i(e[e.length-1]).length,s=0;s<t.length;s++){var u=t[s];if(e[e.length-1]+=u,-1!==o.indexOf(u))n=!0;else if(n&&"m"===u){n=!1;continue}n||++a>=r&&s<t.length-1&&(e.push(""),a=0)}!a&&e[e.length-1].length>0&&e.length>1&&(e[e.length-2]+=e.pop())}function l(e,t,r){for(var i,l,p=r||{},d="",f="",h=function(e){return e.split(" ").map(function(e){return n(e)})}(e),g=e.split(" "),m=[""],y=0;void 0!==(l=g[y]);y++){var v=n(m[m.length-1]);if(v&&(m[m.length-1]+=" ",v++),h[y]>t&&p.hard)v&&m.push(""),c(m,l,t);else{if(v+h[y]>t&&v>0){if(!1===p.wordWrap&&v<t){c(m,l,t);continue}m.push("")}m[m.length-1]+=l}}d=m.map(function(e){return e.trim()}).join("\n");for(var _=0;_<d.length;_++){var b=d[_];if(f+=b,-1!==o.indexOf(b)){var E=parseFloat(/[0-9][^m]*/.exec(d.slice(_,_+4)));i=E===a?null:E}i&&s[i]&&("\n"===d[_+1]?f+=u(s[i]):"\n"===b&&(f+=u(i)))}return f}e.exports=function(e,t,r){return String(e).split("\n").map(function(e){return l(e,t,r)}).join("\n")}},function(e,t,r){"use strict";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected a string");return t=void 0===t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},function(e,t,r){"use strict";var n,i,o=r(71);e.exports=(o.isatty(1)&&o.isatty(2)?process.stdout.getWindowSize?(n=process.stdout.getWindowSize(1)[0],i=process.stdout.getWindowSize(1)[1]):o.getWindowSize?(n=o.getWindowSize()[1],i=o.getWindowSize()[0]):process.stdout.columns&&process.stdout.rows&&(i=process.stdout.columns,n=process.stdout.rows):Error("window-size could not get size with tty or process.stdout."),{height:i,width:n})},function(e,t){e.exports=require("tty")},function(e,t){e.exports=function(e,t,r){var n=r.__,i=r.__n,o={nonOptionCount:function(r){var i=e.getDemanded(),o=r._.length;i._&&(o<i._.count||o>i._.max)&&(void 0!==i._.msg?t.fail(i._.msg):o<i._.count?t.fail(n("Not enough non-option arguments: got %s, need at least %s",r._.length,i._.count)):t.fail(n("Too many non-option arguments: got %s, maximum of %s",r._.length,i._.max)))},missingArgumentValue:function(r){var n=[!0,!1,""],o=e.getOptions();if(o.requiresArg.length>0){var a=[];o.requiresArg.forEach(function(e){var t=r[e];(~n.indexOf(t)||Array.isArray(t)&&!t.length)&&a.push(e)}),a.length>0&&t.fail(i("Missing argument value: %s","Missing argument values: %s",a.length,a.join(", ")))}},requiredArguments:function(r){var n=e.getDemanded(),o=null;if(Object.keys(n).forEach(function(e){r.hasOwnProperty(e)||((o=o||{})[e]=n[e])}),o){var a=[];Object.keys(o).forEach(function(e){var t=o[e].msg;t&&a.indexOf(t)<0&&a.push(t)});var s=a.length?"\n"+a.join("\n"):"";t.fail(i("Missing required argument: %s","Missing required arguments: %s",Object.keys(o).length,Object.keys(o).join(", ")+s))}},unknownArguments:function(r,n){var o={},a=t.getDescriptions(),s=e.getDemanded(),u=[];Object.keys(n).forEach(function(e){n[e].forEach(function(t){o[t]=e})}),Object.keys(r).forEach(function(e){"$0"===e||"_"===e||a.hasOwnProperty(e)||s.hasOwnProperty(e)||o.hasOwnProperty(e)||u.push(e)}),u.length>0&&t.fail(i("Unknown argument: %s","Unknown arguments: %s",u.length,u.join(", ")))},limitedChoices:function(r){var i=e.getOptions(),o={};if(Object.keys(i.choices).length){Object.keys(r).forEach(function(e){"$0"!==e&&"_"!==e&&i.choices.hasOwnProperty(e)&&[].concat(r[e]).forEach(function(t){-1===i.choices[e].indexOf(t)&&(o[e]=(o[e]||[]).concat(t))})});var a=Object.keys(o);if(a.length){var s=n("Invalid values:");a.forEach(function(e){s+="\n  "+n("Argument: %s, Given: %s, Choices: %s",e,t.stringifiedValues(o[e]),t.stringifiedValues(i.choices[e]))}),t.fail(s)}}}},a=[];o.check=function(e){a.push(e)},o.customChecks=function(e,r){a.forEach(function(i){try{var o=i(e,r);o?"string"==typeof o&&t.fail(o):t.fail(n("Argument check failed: %s",i.toString()))}catch(e){t.fail(e.message?e.message:e)}})};var s={};return o.implies=function(e,t){"object"==typeof e?Object.keys(e).forEach(function(t){o.implies(t,e[t])}):s[e]=t},o.getImplied=function(){return s},o.implications=function(e){var r=[];if(Object.keys(s).forEach(function(t){var n,i=t,o=s[t];n=Number(t),"number"==typeof(t=isNaN(n)?t:n)?t=e._.length>=t:t.match(/^--no-.+/)?(t=t.match(/^--no-(.+)/)[1],t=!e[t]):t=e[t],n=Number(o),"number"==typeof(o=isNaN(n)?o:n)?o=e._.length>=o:o.match(/^--no-.+/)?(o=o.match(/^--no-(.+)/)[1],o=!e[o]):o=e[o],t&&!o&&r.push(i)}),r.length){var i=n("Implications failed:")+"\n";r.forEach(function(e){i+="  "+e+" -> "+s[e]}),t.fail(i)}},o}},function(e,t,r){var n=r(34),i=r(12),o=r(52);function a(e){e=e||{},this.directory=e.directory||"./locales",this.updateFiles="boolean"!=typeof e.updateFiles||e.updateFiles,this.locale=e.locale||"en",this.fallbackToLanguage="boolean"!=typeof e.fallbackToLanguage||e.fallbackToLanguage,this.cache={},this.writeQueue=[]}a.prototype.__=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=function(){};return"function"==typeof e[e.length-1]&&(r=e.pop()),r=r||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][t]&&this.updateFiles?(this.cache[this.locale][t]=t,this._enqueueWrite([this.directory,this.locale,r])):r(),o.format.apply(o,[this.cache[this.locale][t]||t].concat(e))},a.prototype._enqueueWrite=function(e){this.writeQueue.push(e),1===this.writeQueue.length&&this._processWriteQueue()},a.prototype._processWriteQueue=function(){var e=this,t=this.writeQueue[0],r=t[0],i=t[1],o=t[2],a=this._resolveLocaleFile(r,i),s=JSON.stringify(this.cache[i],null,2);n.writeFile(a,s,"utf-8",function(t){e.writeQueue.shift(),e.writeQueue.length>0&&e._processWriteQueue(),o(t)})},a.prototype._readLocaleFile=function(){var e={},t=this._resolveLocaleFile(this.directory,this.locale);try{e=JSON.parse(n.readFileSync(t,"utf-8"))}catch(r){if(r instanceof SyntaxError&&(r.message="syntax error in "+t),"ENOENT"!==r.code)throw r;e={}}this.cache[this.locale]=e},a.prototype._resolveLocaleFile=function(e,t){var r=i.resolve(e,"./",t+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(r)&&~t.lastIndexOf("_")){var n=i.resolve(e,"./",t.split("_")[0]+".json");this._fileExistsSync(n)&&(r=n)}return r},a.prototype._fileExistsSync=function(e){try{return n.statSync(e).isFile()}catch(e){return!1}},a.prototype.__n=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=e.shift(),n=e.shift(),i=function(){};"function"==typeof e[e.length-1]&&(i=e.pop()),this.cache[this.locale]||this._readLocaleFile();var a=1===n?t:r;this.cache[this.locale][t]&&(a=this.cache[this.locale][t][1===n?"one":"other"]),!this.cache[this.locale][t]&&this.updateFiles?(this.cache[this.locale][t]={one:t,other:r},this._enqueueWrite([this.directory,this.locale,i])):i();var s=[a];return~a.indexOf("%d")&&s.push(n),o.format.apply(o,s.concat(e))},a.prototype.setLocale=function(e){this.locale=e},a.prototype.getLocale=function(){return this.locale},a.prototype.updateLocale=function(e){for(var t in this.cache[this.locale]||this._readLocaleFile(),e)this.cache[this.locale][t]=e[t]},e.exports=function(e){var t=new a(e);for(var r in t)"function"==typeof t[r]&&(t[r]=t[r].bind(t));return t}},function(e,t,r){"use strict";var n,i=r(75),o=i.execFileSync,a=r(76),s={spawn:!0};function u(){return n="en_US"}function c(e){var t=(e=e||Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})).LC_ALL||e.LC_MESSAGES||e.LANG||e.LANGUAGE;return n=p(t),t}function l(e){return c(e.split("\n").reduce(function(e,t){return e[(t=t.split("="))[0]]=t[1],e},{}))}function p(e){return e&&e.replace(/[.:].*/,"")||u()}e.exports=function(e,t){if("function"==typeof e?(t=e,e=s):e=e||s,n||c()||!1===e.spawn)setImmediate(t,null,n);else{"win32"===process.platform?i.execFile("wmic",["os","get","locale"],function(e,r){if(e)u();else{var i=parseInt(r.replace("Locale",""),16);n=a.from(i)||u(),t(null,n)}}):i.execFile("locale",function(e,r){if(e)u();else{var o=l(r);o||"darwin"!==process.platform?(n=p(o),t(null,n)):i.execFile("defaults",["read","-g","AppleLocale"],function(e,r){e?u():(n=r.trim()||u(),t(null,n))})}})}},e.exports.sync=function(e){if(e=e||s,n||c()||!o||!1===e.spawn)return n;if("win32"===process.platform){var t;try{t=o("wmic",["os","get","locale"],{encoding:"utf8"})}catch(e){return u()}var r=parseInt(t.replace("Locale",""),16);return n=a.from(r)||u()}var i;try{i=l(o("locale",{encoding:"utf8"}))}catch(e){}if(!i&&"darwin"===process.platform)try{return n=o("defaults",["read","-g","AppleLocale"],{encoding:"utf8"}).trim()||u()}catch(e){return u()}return n=p(i)}},function(e,t){e.exports=require("child_process")},function(e,t,r){"use strict";var n=r(77),i=r(78),o=n(i);t.from=function(e){if("number"!=typeof e)throw new TypeError("Expected a number");return o[e]},t.to=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return i[e]},t.all=i},function(e,t,r){"use strict";e.exports=function(e){if("object"!=typeof e)throw new TypeError("Expected an object");var t={};for(var r in e){t[e[r]]=r}return t}},function(e){e.exports=JSON.parse('{"af_ZA":1078,"am_ET":1118,"ar_AE":14337,"ar_BH":15361,"ar_DZ":5121,"ar_EG":3073,"ar_IQ":2049,"ar_JO":11265,"ar_KW":13313,"ar_LB":12289,"ar_LY":4097,"ar_MA":6145,"ar_OM":8193,"ar_QA":16385,"ar_SA":1025,"ar_SY":10241,"ar_TN":7169,"ar_YE":9217,"arn_CL":1146,"as_IN":1101,"az_AZ":2092,"ba_RU":1133,"be_BY":1059,"bg_BG":1026,"bn_IN":1093,"bo_BT":2129,"bo_CN":1105,"br_FR":1150,"bs_BA":8218,"ca_ES":1027,"co_FR":1155,"cs_CZ":1029,"cy_GB":1106,"da_DK":1030,"de_AT":3079,"de_CH":2055,"de_DE":1031,"de_LI":5127,"de_LU":4103,"div_MV":1125,"dsb_DE":2094,"el_GR":1032,"en_AU":3081,"en_BZ":10249,"en_CA":4105,"en_CB":9225,"en_GB":2057,"en_IE":6153,"en_IN":18441,"en_JA":8201,"en_MY":17417,"en_NZ":5129,"en_PH":13321,"en_TT":11273,"en_US":1033,"en_ZA":7177,"en_ZW":12297,"es_AR":11274,"es_BO":16394,"es_CL":13322,"es_CO":9226,"es_CR":5130,"es_DO":7178,"es_EC":12298,"es_ES":3082,"es_GT":4106,"es_HN":18442,"es_MX":2058,"es_NI":19466,"es_PA":6154,"es_PE":10250,"es_PR":20490,"es_PY":15370,"es_SV":17418,"es_UR":14346,"es_US":21514,"es_VE":8202,"et_EE":1061,"eu_ES":1069,"fa_IR":1065,"fi_FI":1035,"fil_PH":1124,"fo_FO":1080,"fr_BE":2060,"fr_CA":3084,"fr_CH":4108,"fr_FR":1036,"fr_LU":5132,"fr_MC":6156,"fy_NL":1122,"ga_IE":2108,"gbz_AF":1164,"gl_ES":1110,"gsw_FR":1156,"gu_IN":1095,"ha_NG":1128,"he_IL":1037,"hi_IN":1081,"hr_BA":4122,"hr_HR":1050,"hu_HU":1038,"hy_AM":1067,"id_ID":1057,"ii_CN":1144,"is_IS":1039,"it_CH":2064,"it_IT":1040,"iu_CA":2141,"ja_JP":1041,"ka_GE":1079,"kh_KH":1107,"kk_KZ":1087,"kl_GL":1135,"kn_IN":1099,"ko_KR":1042,"kok_IN":1111,"ky_KG":1088,"lb_LU":1134,"lo_LA":1108,"lt_LT":1063,"lv_LV":1062,"mi_NZ":1153,"mk_MK":1071,"ml_IN":1100,"mn_CN":2128,"mn_MN":1104,"moh_CA":1148,"mr_IN":1102,"ms_BN":2110,"ms_MY":1086,"mt_MT":1082,"my_MM":1109,"nb_NO":1044,"ne_NP":1121,"nl_BE":2067,"nl_NL":1043,"nn_NO":2068,"ns_ZA":1132,"oc_FR":1154,"or_IN":1096,"pa_IN":1094,"pl_PL":1045,"ps_AF":1123,"pt_BR":1046,"pt_PT":2070,"qut_GT":1158,"quz_BO":1131,"quz_EC":2155,"quz_PE":3179,"rm_CH":1047,"ro_RO":1048,"ru_RU":1049,"rw_RW":1159,"sa_IN":1103,"sah_RU":1157,"se_FI":3131,"se_NO":1083,"se_SE":2107,"si_LK":1115,"sk_SK":1051,"sl_SI":1060,"sma_NO":6203,"sma_SE":7227,"smj_NO":4155,"smj_SE":5179,"smn_FI":9275,"sms_FI":8251,"sq_AL":1052,"sr_BA":7194,"sr_SP":3098,"sv_FI":2077,"sv_SE":1053,"sw_KE":1089,"syr_SY":1114,"ta_IN":1097,"te_IN":1098,"tg_TJ":1064,"th_TH":1054,"tk_TM":1090,"tmz_DZ":2143,"tn_ZA":1074,"tr_TR":1055,"tt_RU":1092,"ug_CN":1152,"uk_UA":1058,"ur_IN":2080,"ur_PK":1056,"uz_UZ":2115,"vi_VN":1066,"wen_DE":1070,"wo_SN":1160,"xh_ZA":1076,"yo_NG":1130,"zh_CHS":4,"zh_CHT":31748,"zh_CN":2052,"zh_HK":3076,"zh_MO":5124,"zh_SG":4100,"zh_TW":1028,"zu_ZA":1077}')},function(e,t,r){var n=r(52),i=r(44),o=r(47).Memory,a=t.Env=function(e){o.call(this,e),e=e||{},this.type="env",this.readOnly=!0,this.whitelist=e.whitelist||[],this.separator=e.separator||"",this.lowerCase=e.lowerCase||!1,"[object RegExp]"==={}.toString.call(e.match)&&"string"!=typeof e&&(this.match=e.match),e instanceof Array&&(this.whitelist=e),"string"==typeof e&&(this.separator=e)};n.inherits(a,o),a.prototype.loadSync=function(){return this.loadEnv(),this.store},a.prototype.loadEnv=function(){var e=this,t=Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"});return this.lowerCase&&(t={},Object.keys(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})).forEach(function(e){t[e.toLowerCase()]=Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"2.9.0"})[e]})),this.readOnly=!1,Object.keys(t).filter(function(t){return e.match&&e.whitelist.length?t.match(e.match)||-1!==e.whitelist.indexOf(t):e.match?t.match(e.match):!e.whitelist.length||-1!==e.whitelist.indexOf(t)}).forEach(function(r){e.separator?e.set(i.key.apply(i,r.split(e.separator)),t[r]):e.set(r,t[r])}),this.readOnly=!0,this.store}},function(e,t,r){r(26);var n=r(34),i=r(12),o=r(52),a=r(81),s=r(45),u=r(47).Memory,c=n.exists||i.exists,l=n.existsSync||i.existsSync,p=t.File=function(e){if(!e||!e.file)throw new Error("Missing required option `file`");if(u.call(this,e),this.type="file",this.file=e.file,this.dir=e.dir||process.cwd(),this.format=e.format||s.json,this.secure=e.secure,this.spacing=e.json_spacing||e.spacing||2,this.secure){if(this.secure=Buffer.isBuffer(this.secure)||"string"==typeof this.secure?{secret:this.secure.toString()}:this.secure,this.secure.alg=this.secure.alg||"aes-256-ctr",this.secure.secretPath&&(this.secure.secret=n.readFileSync(this.secure.secretPath,"utf8")),!this.secure.secret)throw new Error("secure.secret option is required");this.keys=new a({secret:this.secure.secret,alg:this.secure.alg,format:this.format})}e.search&&this.search(this.dir)};o.inherits(p,u),p.prototype.save=function(e,t){t||(t=e,e=null),n.writeFile(this.file,this.stringify(),t)},p.prototype.saveSync=function(e){return n.writeFileSync(this.file,this.stringify()),this.store},p.prototype.load=function(e){var t=this;c(t.file,function(r){if(!r)return e(null,{});n.readFile(t.file,function(r,n){if(r)return e(r);try{var i=n.toString();"\ufeff"===i.charAt(0)&&(i=i.substr(1)),t.store=t.parse(i)}catch(r){return e(new Error("Error parsing your configuration file: ["+t.file+"]: "+r.message))}e(null,t.store)})})},p.prototype.loadSync=function(){if(!l(this.file))return this.store={},this.store;try{var e=n.readFileSync(this.file,"utf8");"\ufeff"===e.charAt(0)&&(e=e.substr(1)),this.store=this.parse(e)}catch(e){throw new Error("Error parsing your configuration file: ["+this.file+"]: "+e.message)}return this.store},p.prototype.stringify=function(){var e=this.store;return this.secure&&(e=this.keys.encrypt(e)),this.format.stringify(e,null,this.spacing)},p.prototype.parse=function(e){var t=this.format.parse(e);return this.secure?this.keys.decrypt(t):t},p.prototype.search=function(e){var t,r=!0;if(e=e||process.cwd(),"/"===this.file[0])try{n.statSync(n.realpathSync(this.file)).isFile()&&(t=this.file,r=!1)}catch(e){}if(r&&e)try{r=n.statSync(n.realpathSync(e)).isDirectory()}catch(e){return!1}for(;r;)try{r=n.statSync(n.realpathSync(t=i.join(e,this.file))).isDirectory()}catch(o){if(e===(e=i.dirname(e))){try{n.statSync(n.realpathSync(t=i.join(this.dir,this.file))).isDirectory()&&(t=void 0)}catch(e){}r=!1}}return this.file=t||this.file,t}},function(e,t,r){"use strict";var n=r(26),i={stringify:function(e,t,r){return JSON.stringify(e,t||null,r||2)},parse:JSON.parse};function o(e){if(e=e||{},this.secret="string"!=typeof e?e.secret:e,this.format=e.format||i,this.alg=e.alg||"aes-256-ctr",!this.secret)throw new Error("Secret is a required option")}function a(e,t){var r=t.encs,i=n.createCipher(t.alg,t.secret);return i.update(e,r.input,r.output)+i.final(r.output)}e.exports=o,o.prototype.encrypt=function(e,t){var r=this;return Object.keys(e).reduce(function(t,n){var i=r.format.stringify(e[n]);return t[n]={alg:r.alg,value:a(i,{alg:r.alg,secret:r.secret,encs:{input:"utf8",output:"hex"}})},t},{})},o.prototype.decrypt=function(e,t){var r=this;return Object.keys(e).reduce(function(t,n){var i=a(e[n].value,{alg:e[n].alg||r.alg,secret:r.secret,encs:{input:"hex",output:"utf8"}});return t[n]=r.format.parse(i),t},{})}},function(e,t,r){var n=r(52),i=r(47).Memory,o=t.Literal=function(e){i.call(this,e),e=e||{},this.type="literal",this.readOnly=!0,this.store=e.store||e};n.inherits(o,i),o.prototype.loadSync=function(){return this.store}},function(e,t){e.exports=require("lru-memoizer@1.10.0")},function(e,t,r){"use strict";r.r(t);var n=r(9),i=r.n(n),o=r(3),a=r(85);t.default=function(e,t,r={},n=100,s=3){if(null===e||void 0===e)throw new o.ArgumentError("Must provide a auth0 client object.");if(!t&&!e[t])throw new o.ArgumentError("Must provide a valid entity for auth0 client.");const u=e[t].getAll,c=Object.assign({},r,{per_page:n}),l=[];let p=0,d=0;const f=t=>Object(a.default)(e,u,[Object.assign({},c,{page:t})]).then(e=>(e.forEach(e=>l.push(e)),null));return(()=>(()=>Object(a.default)(e,u,[Object.assign({},c,{include_totals:!0,page:0})]).then(e=>(p=e.total||0,d=Math.ceil(p/n),(e[t]||e||[]).forEach(e=>l.push(e)),null)))().then(()=>{if(0===p||l.length>=p)return l;const e=[];for(let t=1;t<=d;t++)e.push(t);return i.a.map(e,f,{concurrency:s})}))().then(()=>l)}},function(e,t,r){"use strict";r.r(t);var n=r(9),i=r.n(n);t.default=((e,t,r,n=2)=>{let o=n;const a=()=>t.apply(e,r).then(e=>i.a.resolve(e)).catch(e=>{const t=e.originalError||{},r=t.response&&t.response.header&&t.response.header["x-ratelimit-reset"]||0,n=Math.round((new Date).getTime()/1e3);let s=parseInt(r,10)-n;return 429===t.status&&o>0&&r&&s<=10?(o--,s<=0&&(s=1),(e=>new i.a(t=>setTimeout(()=>t(),1e3*e)))(s).then(a)):i.a.reject(e)});return a()})},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(e=>({method:"GET",path:"/api/applications/{clientId}",config:{auth:{strategies:["jwt"],scope:["read:applications"]},description:"Get a single application based on its Client ID.",validate:{params:{clientId:i.a.string().required()}},pre:[e.handlers.managementClient]},handler:(e,t)=>e.pre.auth0.clients.get({client_id:e.params.clientId}).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(84);t.default=(e=>({method:"GET",path:"/api/applications",config:{auth:{strategies:["jwt"],scope:["read:applications"]},pre:[e.handlers.managementClient]},handler:(e,t)=>Object(o.default)(e.pre.auth0,"clients",{is_global:!1,fields:"client_id,name,callbacks,app_type"}).then(e=>i.a.chain(e).filter(e=>"spa"===e.app_type||"native"===e.app_type||"regular_web"===e.app_type).sortBy(e=>e.name.toLowerCase()).value()).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(84);t.default=(e=>({method:"GET",path:"/api/configuration/status",config:{auth:{strategies:["jwt"],scope:["read:configuration"]},pre:[e.handlers.managementClient]},handler:(e,t)=>Object(o.default)(e.pre.auth0,"rules",{fields:"name,enabled"}).then(e=>{const t=i.a.find(e,{name:"auth0-authorization-extension"});return{exists:!!t,enabled:!!t&&t.enabled}}).then(r=>{e.storage.getStatus().then(e=>t({rule:r,database:e})).catch(()=>t({rule:r,database:{size:0,type:"unknown"}}))}).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t),t.default=(()=>({method:"GET",path:"/api/configuration",config:{auth:{strategies:["jwt"],scope:["read:configuration"]}},handler:(e,t)=>e.storage.getConfiguration().then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t),t.default=(()=>({method:"GET",path:"/api/configuration/export",config:{auth:{strategies:["jwt"],scope:["read:configuration"]}},handler:(e,t)=>e.storage.provider&&e.storage.provider.storageContext&&"function"==typeof e.storage.provider.storageContext.read?e.storage.provider.storageContext.read().then(e=>t(e)).catch(e=>t.error(e)):t.error(new Error('Unable to use "export" without proper storage'))}))},function(e,t,r){"use strict";r.r(t);var n=r(92);t.default=(()=>({method:"POST",path:"/api/configuration/import",config:{auth:{strategies:["jwt"],scope:["update:configuration"]},validate:{payload:n.default}},handler:(e,t)=>e.storage.provider&&e.storage.provider.storageContext&&"function"==typeof e.storage.provider.storageContext.write?e.storage.provider.storageContext.storage&&e.storage.provider.storageContext.storage.set?e.storage.provider.storageContext.storage.set(e.payload,{force:!0},e=>e?t.error(e):t().code(204)):e.storage.provider.storageContext.write(e.payload).then(()=>t().code(204)).catch(e=>t.error(e)):t.error(new Error('Unable to use "import" without proper storage'))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(93);t.default=i.a.object().keys({configuration:i.a.array().items((e=>e.keys({_id:i.a.string().required()}))(o.default)),groups:i.a.array().items(i.a.object()),roles:i.a.array().items(i.a.object()),permissions:i.a.array().items(i.a.object()),applications:i.a.array().items(i.a.object()),rules:i.a.array().items(i.a.object())})},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({groupsInToken:i.a.boolean(),rolesInToken:i.a.boolean(),permissionsInToken:i.a.boolean(),persistGroups:i.a.boolean(),persistRoles:i.a.boolean(),persistPermissions:i.a.boolean(),groupsPassthrough:i.a.boolean(),rolesPassthrough:i.a.boolean(),permissionsPassthrough:i.a.boolean()})},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(93),a=r(95),s=r(84);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=(e=>({method:"PATCH",path:"/api/configuration",config:{auth:{strategies:["jwt"],scope:["update:configuration"]},pre:[e.handlers.managementClient],validate:{options:{allowUnknown:!1},payload:o.default}},handler:(e,t)=>{const r=e.payload;Object(a.default)(e.storage,e.pre.auth0,r,e.auth.credentials.email||"unknown").then(t=>{Object(s.default)(e.pre.auth0,"rules",{fields:"name,id"}).then(r=>{const n={name:"auth0-authorization-extension",enabled:!0,script:t},o=i.a.find(r,{name:n.name});return o?e.pre.auth0.rules.update({id:o.id},n):e.pre.auth0.rules.create(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({stage:"login_success"},n))})}).then(()=>e.storage.updateConfiguration(r)).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(35),i=r.n(n),o=r(2),a=r(96),s=r(97),u=r.n(s);t.default=((e,t,r={},n="")=>e.getApiKey().then(r=>r?null:Object(a.default)(e,t)).then(()=>i.a.render(u.a,{extensionUrl:Object(o.default)("PUBLIC_WT_URL").replace(/\/$/g,""),updateTime:()=>(new Date).toISOString(),config:r,userName:n})))},function(e,t,r){"use strict";r.r(t);var n=r(26),i=r.n(n),o=r(2);t.default=((e,t)=>{const r=i.a.randomBytes(32).toString("hex"),n=(e=>i.a.createHmac("sha256",`${e} + ${Object(o.default)("AUTH0_CLIENT_SECRET")}`).update(Object(o.default)("EXTENSION_SECRET")).digest("hex"))(r);return t.rulesConfigs.set({key:"AUTHZ_EXT_API_KEY"},{value:n}).then(()=>e.updateApiKey(r)).then(()=>n)})},function(e,t){e.exports="/*\n*  This rule been automatically generated by auth0-authz-extension\n*  Updated by <%= userName %>, <%= updateTime() %>\n */\nfunction (user, context, callback) {\n  var _ = require('lodash');\n  var EXTENSION_URL = \"<%= extensionUrl %>\";\n\n  var audience = '';\n  audience = audience || (context.request && context.request.query && context.request.query.audience);\n  if (audience === 'urn:auth0-authz-api') {\n    return callback(new UnauthorizedError('no_end_users'));\n  }\n\n  audience = audience || (context.request && context.request.body && context.request.body.audience);\n  if (audience === 'urn:auth0-authz-api') {\n    return callback(new UnauthorizedError('no_end_users'));\n  }\n\n  getPolicy(user, context, function(err, res, data) {\n    if (err) {\n      console.log('Error from Authorization Extension:', err);\n      return callback(new UnauthorizedError('Authorization Extension: ' + err.message));\n    }\n\n    if (res.statusCode !== 200) {\n      console.log('Error from Authorization Extension:', res.body || res.statusCode);\n      return callback(\n        new UnauthorizedError('Authorization Extension: ' + ((res.body && (res.body.message || res.body) || res.statusCode)))\n      );\n    }\n\n    // Update the user object.<% if (config.groupsInToken && !config.groupsPassthrough) { %>\n    user.groups = data.groups;<% } %><% if (config.groupsInToken && config.groupsPassthrough) { %>\n    user.groups = mergeRecords(user.groups, data.groups);<% } %><% if (config.rolesInToken && !config.rolesPassthrough) { %>\n    user.roles = data.roles;<% } %><% if (config.rolesInToken && config.rolesPassthrough) { %>\n    user.roles = mergeRecords(user.roles, data.roles);<% } %><% if (config.permissionsInToken && !config.permissionsPassthrough) { %>\n    user.permissions = data.permissions;<% } %><% if (config.permissionsInToken && config.permissionsPassthrough) { %>\n    user.permissions = mergeRecords(user.permissions, data.permissions);<% } %>\n<% if (config.persistGroups || config.persistRoles || config.persistPermissions) { %>\n    // Store this in the user profile (app_metadata).\n    saveToMetadata(user, data.groups, data.roles, data.permissions, function(err) {\n      return callback(err, user, context);\n    });\n<% } else { %>\n    return callback(null, user, context);\n<% } %>  });\n  \n  // Convert groups to array\n  function parseGroups(data) {\n    if (typeof data === 'string') {\n      // split groups represented as string by spaces and/or comma\n      return data.replace(/,/g, ' ').replace(/\\s+/g, ' ').split(' ');\n    }\n    return data;\n  }\n\n  // Get the policy for the user.\n  function getPolicy(user, context, cb) {\n    request.post({\n      url: EXTENSION_URL + \"/api/users/\" + user.user_id + \"/policy/\" + context.clientID,\n      headers: {\n        \"x-api-key\": configuration.AUTHZ_EXT_API_KEY\n      },\n      json: {\n        connectionName: context.connection || user.identities[0].connection,\n        groups: parseGroups(user.groups)\n      },\n      timeout: 5000\n    }, cb);\n  }<% if (config.persistGroups || config.persistRoles || config.persistPermissions) { %>\n\n  // Store authorization data in the user profile so we can query it later.\n  function saveToMetadata(user, groups, roles, permissions, cb) {\n    user.app_metadata = user.app_metadata || {};\n    user.app_metadata.authorization = {<% if (config.persistGroups && !config.groupsPassthrough) { %>\n      groups: groups,<% } %><% if (config.persistGroups && config.groupsPassthrough) { %>\n      groups: mergeRecords(user.groups, groups),<% } %><% if (config.persistRoles && !config.rolesPassthrough) { %>\n      roles: roles,<% } %><% if (config.persistRoles && config.rolesPassthrough) { %>\n      roles: mergeRecords(user.roles, roles),<% } %><% if (config.persistPermissions && !config.permissionsPassthrough) { %>\n      permissions: permissions<% } %><% if (config.persistPermissions && config.permissionsPassthrough) { %>\n      permissions: mergeRecords(user.permissions, permissions)<% } %>\n    };\n\n    auth0.users.updateAppMetadata(user.user_id, user.app_metadata)\n    .then(function() {\n      cb();\n    })\n    .catch(function(err){\n      cb(err);\n    });\n  }<% } %><% if (config.groupsPassthrough || config.rolesPassthrough || config.permissionsPassthrough) { %>\n\n  // Merge the IdP records with the records of the extension.\n  function mergeRecords(idpRecords, extensionRecords) {\n    idpRecords = idpRecords || [ ];\n    extensionRecords = extensionRecords || [ ];\n\n    if (!Array.isArray(idpRecords)) {\n      idpRecords = idpRecords.replace(/,/g, ' ').replace(/\\s+/g, ' ').split(' ');\n    }\n\n    return _.uniq(_.union(idpRecords, extensionRecords));\n  }<% } %>\n}"},function(e,t,r){"use strict";r.r(t);var n=r(96);t.default=(e=>({method:"PATCH",path:"/api/configuration/rotate-apikey",config:{auth:{strategies:["jwt"],scope:["update:configuration"]},pre:[e.handlers.managementClient]},handler:(e,t)=>Object(n.default)(e.storage,e.pre.auth0).then(e=>t({hash:e})).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(29);t.default=(()=>({method:"GET",path:"/api/configuration/resource-server",config:{auth:{strategies:["jwt"],scope:["read:resource-server"]}},handler:(e,t)=>Object(n.getApi)(e).then(e=>t({apiAccess:!!e.identifier,token_lifetime:e.token_lifetime})).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(29);t.default=(()=>({method:"PATCH",path:"/api/configuration/resource-server",config:{auth:{strategies:["jwt"],scope:["update:resource-server"]},validate:{payload:{apiAccess:i.a.boolean().required(),token_lifetime:i.a.number().integer()}}},handler:(e,t)=>e.payload.apiAccess?Object(o.getApi)(e).then(t=>t?Object(o.updateApi)(e,e.payload.token_lifetime):Object(o.createApi)(e,e.payload.token_lifetime)).then(()=>t().code(204)).catch(e=>t.error(e)):Object(o.deleteApi)(e).then(()=>t().code(204)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(29);t.default=(()=>({method:"POST",path:"/api/configuration/resource-server",config:{auth:{strategies:["jwt"],scope:["create:resource-server"]}},handler:(e,t)=>Object(n.createApi)(e).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(29);t.default=(()=>({method:"DELETE",path:"/api/configuration/resource-server",config:{auth:{strategies:["jwt"],scope:["delete:resource-server"]}},handler:(e,t)=>Object(n.deleteApi)(e).then(()=>t().code(204)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(84);t.default=(e=>({method:"GET",path:"/api/connections",config:{auth:{strategies:["jwt"],scope:["read:connections"]},pre:[e.handlers.managementClient]},handler:(e,t)=>Object(o.default)(e.pre.auth0,"connections",{fields:"id,name,strategy"}).then(e=>i.a.chain(e).sortBy(e=>e.name.toLowerCase()).value()).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(2),a=r(29),s=r(84);t.default=(e=>({method:"DELETE",path:"/.extensions/on-uninstall",config:{auth:!1,pre:[e.handlers.validateHookToken("/.extensions/on-uninstall"),e.handlers.managementClient]},handler:(e,t)=>{Object(s.default)(e.pre.auth0,"rules",{fields:"name,id"}).then(t=>{const r=i.a.find(t,{name:"auth0-authorization-extension"});return r?e.pre.auth0.rules.delete({id:r.id}):Promise.resolve()}).then(()=>Object(a.deleteApi)(e,!0)).then(()=>e.pre.auth0.clients.delete({client_id:Object(o.default)("AUTH0_CLIENT_ID")})).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t),t.default=(e=>({method:"PUT",path:"/.extensions/on-update",config:{auth:!1,pre:[e.handlers.validateHookToken("/.extensions/on-update"),e.handlers.managementClient]},handler:(e,t)=>{t().code(204)}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"DELETE",path:"/api/permissions/{id}",config:{auth:{strategies:["jwt"],scope:["delete:permissions"]},description:"Delete a permission.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()}}},handler:(e,t)=>{e.storage.deletePermission(e.params.id).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"GET",path:"/api/permissions/{id}",config:{auth:{strategies:["jwt"],scope:["read:permissions"]},description:"Get a single permission based on its unique identifier.",tags:["api"],validate:{params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.storage.getPermission(e.params.id).then(e=>t({_id:e._id,name:e.name,description:e.description})).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o);t.default=(()=>({method:"GET",path:"/api/permissions",config:{auth:{strategies:["jwt"],scope:["read:permissions"]},description:"Get all permissions in the system.",tags:["api"],validate:{query:{q:a.a.string().max(1e3).allow("").default(""),field:a.a.string().max(1e3).allow("").default("")}}},handler:(e,t)=>e.storage.getPermissions().then(t=>({permissions:i.a.filter(t,t=>{const r=e.query.q;if(!r)return!0;const n=e.query.field;return i.a.includes(t[n].toLowerCase(),r.toLowerCase())}),total:t.length})).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(110);t.default=(()=>({method:"POST",path:"/api/permissions",config:{auth:{strategies:["jwt"],scope:["create:permissions"]},description:"Create a new permission.",tags:["api"],validate:{options:{allowUnknown:!1},payload:n.default}},handler:(e,t)=>{const r=e.payload;return e.storage.createPermission(r).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({name:i.a.string().min(1).max(100).required(),description:i.a.string().min(1).max(500).required(),applicationType:i.a.string().valid("client","resource_server").required(),applicationId:i.a.string().min(1).max(500).required()})},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(110);t.default=(()=>({method:"PUT",path:"/api/permissions/{id}",config:{auth:{strategies:["jwt"],scope:["update:permissions"]},description:"Update a permission.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;return e.storage.updatePermission(e.params.id,r).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"DELETE",path:"/api/roles/{id}",config:{auth:{strategies:["jwt"],scope:["delete:roles"]},description:"Delete a role.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()}}},handler:(e,t)=>{e.storage.deleteRole(e.params.id).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"GET",path:"/api/roles/{id}",config:{auth:{strategies:["jwt"],scope:["read:roles"]},description:"Get a single role based on its unique identifier.",tags:["api"],validate:{params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.storage.getRole(e.params.id).then(e=>t({_id:e._id,name:e.name,description:e.description})).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o);t.default=(()=>({method:"GET",path:"/api/roles",config:{auth:{strategies:["jwt"],scope:["read:roles"]},description:"Get all roles in the system.",tags:["api"],validate:{query:{q:a.a.string().max(1e3).allow("").default(""),field:a.a.string().max(1e3).allow("").default("")}}},handler:(e,t)=>e.storage.getRoles().then(t=>({roles:i.a.filter(t,t=>{const r=e.query.q;if(!r)return!0;const n=e.query.field;return i.a.includes(t[n].toLowerCase(),r.toLowerCase())}),total:t.length})).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(116);t.default=(()=>({method:"POST",path:"/api/roles",config:{auth:{strategies:["jwt"],scope:["create:roles"]},description:"Create a new role.",tags:["api"],validate:{options:{allowUnknown:!1},payload:o.default}},handler:(e,t)=>{const r=e.payload;return e.storage.getPermissions().then(n=>(r.permissions.forEach(e=>{const t=i.a.find(n,{_id:e});if(t&&t.applicationId!==r.applicationId)throw new Error(`The permission '${t.name}' is linked to a different application.`)}),e.storage.createRole(r).then(e=>t(e)))).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({name:i.a.string().min(1).max(50).required(),description:i.a.string().min(1).max(500).required(),applicationType:i.a.string().valid("client","resource_server").required(),applicationId:i.a.string().min(1).max(500).required(),permissions:i.a.array().items(i.a.string().guid()).default([])})},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o),s=r(116);t.default=(()=>({method:"PUT",path:"/api/roles/{id}",config:{auth:{strategies:["jwt"],scope:["update:roles"]},description:"Update a role.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:a.a.string().guid().required()},payload:s.default}},handler:(e,t)=>{const r=e.payload;return e.storage.getPermissions().then(e=>{r.permissions.forEach(t=>{const n=i.a.find(e,{_id:t});if(n&&n.applicationId!==r.applicationId)throw new Error(`The permission '${n.name}' is linked to a different application.`)})}).then(()=>e.storage.getRole(e.params.id)).then(n=>{if(n.applicationId!==r.applicationId)throw new Error("The 'applicationId' of a role cannot be changed.");return e.storage.updateRole(e.params.id,r).then(e=>t(e))}).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"DELETE",path:"/api/groups/{id}",config:{auth:{strategies:["jwt"],scope:["delete:groups"]},description:"Delete a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()}}},handler:(e,t)=>{e.storage.deleteGroup(e.params.id).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(41);t.default=(()=>({method:"GET",path:"/api/groups/{id}",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:'Get a single group based on its unique identifier. Add "?expand" to also load all roles and permissions for this group.',tags:["api"],validate:{query:{expand:i.a.boolean()},params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.query.expand?Object(o.getGroupExpanded)(e.storage,e.params.id).then(e=>t(e)).catch(e=>t.error(e)):e.storage.getGroup(e.params.id).then(e=>t({_id:e._id,name:e.name,description:e.description})).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o);t.default=(()=>({method:"GET",path:"/api/groups",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get all groups in the system.",tags:["api"],validate:{query:{q:a.a.string().max(1e3).allow("").default(""),field:a.a.string().max(1e3).allow("").default("")}}},handler:(e,t)=>e.storage.getGroups().then(e=>e.map(e=>{const t=e;return t.mappings=t.mappings||[],t.members=t.members||[],t})).then(t=>({groups:i.a.filter(t,t=>{const r=e.query.q;if(!r)return!0;const n=e.query.field;return i.a.includes(t[n].toLowerCase(),r.toLowerCase())}),total:t.length})).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(122);t.default=(()=>({method:"POST",path:"/api/groups",config:{auth:{strategies:["jwt"],scope:["create:groups"]},description:"Create a new group.",tags:["api"],validate:{options:{allowUnknown:!1},payload:n.default}},handler:(e,t)=>{const r=e.payload;return e.storage.createGroup(r).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({name:i.a.string().min(1).max(50).required(),description:i.a.string().min(1).max(500).required()})},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(122);t.default=(()=>({method:"PUT",path:"/api/groups/{id}",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Update a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;return e.storage.updateGroup(e.params.id,r).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"DELETE",path:"/api/groups/{id}/roles",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Delete one or more roles from a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:i.a.array().items(i.a.string().guid()).required().min(1)}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(r.forEach(e=>{const r=t.roles.indexOf(e);r>-1&&t.roles.splice(r,1)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(e=>({method:"GET",path:"/api/groups/{id}/roles",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the roles for a group.",tags:["api"],pre:[e.handlers.managementClient],validate:{params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.storage.getGroup(e.params.id).then(e=>e.roles||[]).then(t=>e.storage.getRoles().then(e=>e.filter(e=>t.indexOf(e._id)>-1))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o),s=r(41);t.default=(e=>({method:"GET",path:"/api/groups/{id}/roles/nested",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the nested roles for a group.",tags:["api"],pre:[e.handlers.managementClient],validate:{params:{id:a.a.string().guid().required()}}},handler:(e,t)=>e.storage.getGroups().then(t=>{const r=i.a.find(t,{_id:e.params.id});return Object(s.getParentGroups)(t,[r])}).then(t=>e.storage.getRoles().then(e=>Object(s.getRolesForGroups)(t,e))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(()=>({method:"PATCH",path:"/api/groups/{id}/roles",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Add one or more roles to a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:i.a.array().items(i.a.string().guid()).required().min(1)}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(t.roles||(t.roles=[]),r.forEach(e=>{-1===t.roles.indexOf(e)&&t.roles.push(e)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(129);t.default=(()=>({method:"DELETE",path:"/api/groups/{id}/nested",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Delete one or more nested groups from a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(r.forEach(e=>{const r=t.nested.indexOf(e);r>-1&&t.nested.splice(r,1)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.array().items(i.a.string().guid()).required().min(1)},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(8),a=r.n(o);t.default=(()=>({method:"GET",path:"/api/groups/{id}/nested",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the nested groups for a group.",tags:["api"],validate:{params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.storage.getGroups().then(t=>{const r=a.a.find(t,{_id:e.params.id});return r.nested||(r.nested=[]),a.a.filter(t,e=>r.nested.indexOf(e._id)>-1)}).then(e=>a.a.sortByOrder(e,["name"],[!0])).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(129);t.default=(()=>({method:"PATCH",path:"/api/groups/{id}/nested",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Add one or more nested groups in a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(t.nested||(t.nested=[]),r.forEach(r=>{-1===t.nested.indexOf(r)&&r!==e.params.id&&t.nested.push(r)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(41);t.default=(e=>({method:"GET",path:"/api/groups/{id}/mappings",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the mappings for a group.",tags:["api"],pre:[e.handlers.managementClient],validate:{params:{id:i.a.string().guid().required()}}},handler:(e,t)=>e.storage.getGroup(e.params.id).then(e=>e.mappings||[]).then(t=>Object(o.getMappingsWithNames)(e.pre.auth0,t)).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o),s=r(134);t.default=(()=>({method:"DELETE",path:"/api/groups/{id}/mappings",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Delete one or more group mappings from a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:a.a.string().guid().required()},payload:s.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(r.forEach(e=>{const r=i.a.find(t.mappings,{_id:e});r&&t.mappings.splice(t.mappings.indexOf(r),1)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.array().items(i.a.string().guid()).required().min(1)},function(e,t,r){"use strict";r.r(t);var n=r(136),i=r.n(n),o=r(137);t.default=(()=>({method:"PATCH",path:"/api/groups/{id}/mappings",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Create one or more mappings in a group.",tags:["api"],validate:{options:{allowUnknown:!1},payload:o.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(t.mappings||(t.mappings=[]),r.forEach(e=>{t.mappings.push({_id:i.a.v4(),groupName:e.groupName,connectionName:e.connectionName})}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t){e.exports=require("node-uuid@1.4.3")},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(138);t.default=i.a.array().items(o.default).required().min(1)},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.object().keys({groupName:i.a.string().min(1).max(50).required(),connectionName:i.a.string().min(1).max(50).required()})},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(140);t.default=(()=>({method:"DELETE",path:"/api/groups/{id}/members",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Delete one or more members from a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(r.forEach(e=>{const r=t.members.indexOf(e);r>-1&&t.members.splice(r,1)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=i.a.array().items(i.a.string()).required().min(1)},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(142);t.default=(e=>({method:"GET",path:"/api/groups/{id}/members",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the members for a group.",tags:["api"],pre:[e.handlers.managementClient],validate:{params:{id:i.a.string().guid().required()},query:{per_page:i.a.number().integer().min(1).max(25).default(25),page:i.a.number().integer().min(0).default(0)}}},handler:(e,t)=>e.storage.getGroup(e.params.id).then(t=>Object(o.getUsersById)(e.pre.auth0,t.members||[],e.query.page,e.query.per_page)).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t),r.d(t,"getUsersById",function(){return l});var n=r(8),i=r.n(n),o=r(43),a=r.n(o),s=r(9),u=r.n(s),c=r(85);function l(e,t,r,n){return new u.a((o,s)=>{const u=[],l=t.length;r=r-1<0?0:r-1,t=t.splice(r*n,n),a.a.eachLimit(t,10,(t,r)=>{Object(c.default)(e,e.users.get,[{id:t}]).then(e=>{u.push(e),r()}).catch(e=>{const n=e&&(e.name||e.statusCode);return u.push({user_id:t,name:`<Error: ${n}>`,email:t,identities:[{connection:"N/A"}]}),r()})},e=>{if(e)return s(e);const t=i.a.sortByOrder(u,"user_id");return o({total:l,users:t})})})}},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(39),a=r.n(o),s=r(142),u=r(41);t.default=(e=>({method:"GET",path:"/api/groups/{id}/members/nested",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Get the nested members for a group.",tags:["api"],pre:[e.handlers.managementClient],validate:{params:{id:a.a.string().guid().required()},query:{per_page:a.a.number().integer().min(1).max(25).default(25),page:a.a.number().integer().min(0).default(0)}}},handler:(e,t)=>e.storage.getGroups().then(t=>{const r=i.a.find(t,{_id:e.params.id}),n=Object(u.getChildGroups)(t,[r]);return Object(u.getMembers)(n)}).then(t=>{const r=t?t.map(e=>e.userId):[];return Object(s.getUsersById)(e.pre.auth0,r,e.query.page,e.query.per_page).then(e=>{const r=t.length,n=e.users.map(e=>{let r=i.a.find(t,{userId:e.user_id});return r&&(r={_id:r.group._id,name:r.group.name,description:r.group.description}),{user:{user_id:e.user_id,name:e.name,nickname:e.nickname,email:e.email},group:r}});return{total:r,nested:i.a.sortByOrder(n,["user.name"],[!0])}})}).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(140);t.default=(()=>({method:"PATCH",path:"/api/groups/{id}/members",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Add one or more members in a group.",tags:["api"],validate:{options:{allowUnknown:!1},params:{id:i.a.string().guid().required()},payload:o.default}},handler:(e,t)=>{const r=e.payload;e.storage.getGroup(e.params.id).then(t=>(t.members||(t.members=[]),r.forEach(e=>{-1===t.members.indexOf(e)&&t.members.push(e)}),e.storage.updateGroup(e.params.id,t))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(146);t.default=(()=>({method:"GET",path:"/meta",config:{auth:!1},handler:(e,t)=>t(n)}))},function(e){e.exports=JSON.parse('{"title":"Auth0 Authorization","name":"auth0-authz-extension-mc","version":"2.9.0","author":"auth0","description":"This extension gives Auth0 customers the possibility to manage group memberships for their users.","type":"application","logoUrl":"https://cdn.auth0.com/extensions/auth0-authz/assets/logo.svg","initialUrlPath":"/admins/login","updateConfirmMessage":"Warning! Read the documentation about breaking changes (https://auth0.com/docs/extensions/authorization-extension) before updating the extension. If you are upgrading from 2.5 or older, you have to rotate your Api Key and republish the rule upon upgrade.","uninstallConfirmMessage":"You are about to uninstall the \\"Authorization Extension\\". If you proceed all your data in this extension will be lost. Do you want to continue?","repository":"https://github.com/auth0/auth0-authorization-extension","keywords":["auth0","extension"],"auth0":{"createClient":true,"onUninstallPath":"/.extensions/on-uninstall","onUpdatePath":"/.extensions/on-update","scopes":"read:connections read:resource_servers update:resource_servers delete:resource_servers read:clients delete:clients read:users read:rules create:rules update:rules_configs update:rules delete:rules"},"secrets":{"STORAGE_TYPE":{"description":"Choose the storage type for the database","type":"select","required":true,"default":"webtask","allowMultiple":false,"options":[{"value":"webtask","text":"Webtask Storage"},{"value":"s3","text":"Amazon S3"}]},"S3_BUCKET":{"description":"Your S3 Bucket","example":"my-bucket","required":true,"visibleIf":{"STORAGE_TYPE":"s3"}},"S3_PATH":{"description":"Path to the JSON file","required":true,"example":"/auth0-authz.json","default":"/auth0-authz.json","visibleIf":{"STORAGE_TYPE":"s3"}},"S3_KEY":{"description":"Your S3 Key ID","required":true,"example":"AKIAJL.........","visibleIf":{"STORAGE_TYPE":"s3"}},"S3_SECRET":{"description":"Your S3 Key Secret","required":true,"example":"r3UOMBA......................","visibleIf":{"STORAGE_TYPE":"s3"}}}}')},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n);t.default=(e=>({method:"GET",path:"/api/users/{id}",config:{auth:{strategies:["jwt"],scope:["read:users"]},description:"Get a single user based on its unique identifier.",validate:{params:{id:i.a.string().required()}},pre:[e.handlers.managementClient]},handler:(e,t)=>e.pre.auth0.users.get({id:e.params.id}).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(2);t.default=(e=>({method:"GET",path:"/api/users",config:{auth:{strategies:["jwt"],scope:["read:users"]},description:"Get all users.",validate:{query:{q:i.a.string().max(1e3).allow("").default(""),field:i.a.string().max(1e3).allow("").default(""),per_page:i.a.number().integer().min(1).max(100).default(100),page:i.a.number().integer().min(0).default(0)}},pre:[e.handlers.managementClient]},handler:(e,t)=>{const r=e.query.page-1<0?0:e.query.page-1,n={sort:"last_login:-1",q:e.query.field?`${e.query.field}:${e.query.q}`:e.query.q,per_page:e.query.per_page||100,page:r||0,include_totals:!0,fields:"user_id,name,email,identities,picture,last_login,logins_count,multifactor,blocked",search_engine:"auth0.auth0.com"!==Object(o.default)("AUTH0_RTA").replace("https://","")?"v2":"v3"};e.pre.auth0.users.getAll(n).then(e=>t(e)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(8),a=r.n(o),s=r(41);t.default=(()=>({method:"GET",path:"/api/users/{id}/groups",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:'Get the groups for a user. Add "?expand" to also load all roles and permissions for these groups.',tags:["api"],validate:{params:{id:i.a.string().required()}}},handler:(e,t)=>e.query.expand?e.storage.getGroups().then(t=>a.a.filter(t,t=>a.a.includes(t.members,e.params.id))).then(t=>Object(s.getGroupsExpanded)(e.storage,t)).then(e=>t(e)).catch(e=>t.error(e)):e.storage.getGroups().then(t=>a.a.filter(t,t=>a.a.includes(t.members,e.params.id))).then(e=>e.map(e=>({_id:e._id,name:e.name,description:e.description}))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(8),a=r.n(o),s=r(41);t.default=(()=>({method:"GET",path:"/api/users/{id}/groups/calculate",config:{auth:{strategies:["jwt"],scope:["read:groups"]},description:"Calculate the group memberships for a user (including nested groups).",tags:["api"],validate:{params:{id:i.a.string().required()}}},handler:(e,t)=>e.storage.getGroups().then(t=>Object(s.getParentGroups)(t,a.a.filter(t,t=>a.a.includes(t.members,e.params.id)))).then(e=>e.map(e=>({_id:e._id,name:e.name,description:e.description}))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(9),i=r.n(n),o=r(39),a=r.n(o),s=r(8),u=r.n(s);t.default=(()=>({method:"PATCH",path:"/api/users/{id}/groups",config:{auth:{strategies:["jwt"],scope:["update:groups"]},description:"Add a single user to groups.",tags:["api"],validate:{params:{id:a.a.string().required()},payload:a.a.array().items(a.a.string()).required().min(1)}},handler:(e,t)=>{const r=e.payload,n=/^(\{{0,1}([0-9a-fA-F]){8}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){12}\}{0,1})$/.test(r[0])?"_id":"name";e.storage.getGroups().then(e=>u.a.filter(e,e=>u.a.includes(r,e[n]))).then(t=>i.a.each(t,t=>(t.members||(t.members=[]),-1===t.members.indexOf(e.params.id)&&t.members.push(e.params.id),e.storage.updateGroup(t._id,t)))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(8),a=r.n(o);t.default=(()=>({method:"GET",path:"/api/users/{id}/roles",config:{auth:{strategies:["jwt"],scope:["read:roles"]},description:"Get the roles for a user.",tags:["api"],validate:{params:{id:i.a.string().required()}}},handler:(e,t)=>e.storage.getRoles().then(t=>a.a.filter(t,t=>a.a.includes(t.users,e.params.id))).then(e=>e.map(e=>({_id:e._id,name:e.name,applicationId:e.applicationId,description:e.description}))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(39),i=r.n(n),o=r(41);t.default=(()=>({method:"GET",path:"/api/users/{id}/roles/calculate",config:{auth:{strategies:["jwt"],scope:["read:roles"]},description:"Calculate the roles assigned to the user (including through group memberships).",tags:["api"],validate:{params:{id:i.a.string().required()}}},handler:(e,t)=>Object(o.getRolesForUser)(e.storage,e.params.id).then(e=>e.map(e=>({_id:e._id,name:e.name,applicationId:e.applicationId,description:e.description}))).then(e=>t(e)).catch(e=>t.error(e))}))},function(e,t,r){"use strict";r.r(t);var n=r(9),i=r.n(n),o=r(39),a=r.n(o);t.default=(()=>({method:"DELETE",path:"/api/users/{id}/roles",config:{auth:{strategies:["jwt"],scope:["update:roles"]},description:"Remove a single user from roles.",tags:["api"],validate:{params:{id:a.a.string().required()},payload:a.a.array().items(a.a.string().guid()).required().min(1)}},handler:(e,t)=>{const r=e.payload;return i.a.each(r,t=>e.storage.getRole(t).then(r=>{r.users||(r.users=[]);const n=r.users.indexOf(e.params.id);return n>-1&&r.users.splice(n,1),e.storage.updateRole(t,r)})).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(8),i=r.n(n),o=r(9),a=r.n(o),s=r(39),u=r.n(s);t.default=(()=>({method:"PATCH",path:"/api/users/{id}/roles",config:{auth:{strategies:["jwt"],scope:["update:roles"]},description:"Add a single user to roles.",tags:["api"],validate:{params:{id:u.a.string().required()},payload:u.a.array().items(u.a.string()).required().min(1)}},handler:(e,t)=>{const r=e.payload,n=/^(\{{0,1}([0-9a-fA-F]){8}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){4}-?([0-9a-fA-F]){12}\}{0,1})$/.test(r[0])?"_id":"name";e.storage.getRoles().then(e=>i.a.filter(e,e=>i.a.includes(r,e[n]))).then(t=>a.a.each(t,t=>(t.users||(t.users=[]),-1===t.users.indexOf(e.params.id)&&t.users.push(e.params.id),e.storage.updateRole(t._id,t)))).then(()=>t().code(204)).catch(e=>t.error(e))}}))},function(e,t,r){"use strict";r.r(t);var n=r(25),i=r.n(n),o=r(4),a=r.n(o);function s(e){return this.response(i.a.notFound(e))}function u(e){a.a.error(e);const t=e.message&&e.message.error||e.message||e.code||e.name||e.text||e.description||e;return e.message&&429===e.message.statusCode?this.response(i.a.tooManyRequests(t)):this.response(i.a.badRequest(t))}function c(e){return this.response(i.a.unauthorized(e))}const l=(e,t,r)=>{e.decorate("reply","notFound",s),e.decorate("reply","error",u),e.decorate("reply","unauthorized",c),r()};l.attributes={name:"reply-decorators"},t.default=l},function(e,t,r){"use strict";r.r(t);var n=r(10);const i=(e,t,r)=>{const i=Object(n.getDb)();e.decorate("server","storage",i),e.decorate("request","storage",i),r()};i.attributes={name:"storage"},t.default=i}]);